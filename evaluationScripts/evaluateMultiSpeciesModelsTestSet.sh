# Get positive test set for brain
# Mouse
grep -P 'chr1\t|chr2\t' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_withPeakNames.bed | awk 'BEGIN{OFS="\t"} {print $1,$2+$10-250, $2+$10+250}' | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseGenome/mm10.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_summitPlusMinus250bp_test.fa
# Human
awk 'BEGIN{OFS="\t"} {print $1, $2+$10-250, $2+$10+250}' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatum_nonCDS_enhancerShort_mouseTest.bed | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanGenome/hg38.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatum_nonCDS_enhancerShort_mouseTest_summitPlusMinus250bp.fa
# Macaque
awk 'BEGIN{OFS="\t"} {print $1, $2+$10-250, $2+$10+250}' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatum_nonCDS_enhancerShort_mouseTest.bed | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueGenome/rheMac8.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatum_nonCDS_enhancerShort_mouseTest_summitPlusMinus250bp.fa
# Rat
awk 'BEGIN{OFS="\t"} {print $1, $2+$10-250, $2+$10+250}' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatum_nonCDS_enhancerShort_mouseTest.bed | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatGenome/rn6.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatum_nonCDS_enhancerShort_summitPlusMinus250bp_mouseTest.fa
# Combine
cat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_summitPlusMinus250bp_test.fa /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatum_nonCDS_enhancerShort_mouseTest_summitPlusMinus250bp.fa /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatum_nonCDS_enhancerShort_mouseTest_summitPlusMinus250bp.fa /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatum_nonCDS_enhancerShort_summitPlusMinus250bp_mouseTest.fa > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_summitPlusMinus250bp_andHuman_andMacaque_andRat_test.fa

# Get positive set for liver
# Mouse
grep -P 'chr1\t|chr2\t' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort.bed | awk 'BEGIN{OFS="\t"} {print $1,$2+$10-250, $2+$10+250}' | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseGenome/mm10.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.inLiuAll_nonCDS_enhancerShort_test_summitPlusMinus250bp.fa
# Macaque
awk 'BEGIN{OFS="\t"} {print $1,$2+$10-250, $2+$10+250}' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_mouseTest.bed | awk 'BEGIN{OFS="\t"} $2 >= 0' | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueGenome/rheMac8.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_mouseTest_summitPlusMinus250bp.fa
# Rat
awk 'BEGIN{OFS="\t"} {print $1,$2+$10-250, $2+$10+250}' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/Liver_GoodReps/peak/idr_reproducibility/idr.optimal_peak_nonCDS_enhancerShort_mouseTest.bed | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatGenome/rn6.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/Liver_GoodReps/peak/idr_reproducibility/idr.optimal_peak_nonCDS_enhancerShort_mouseTest_summitPlusMinus250bp.fa
# Combine
cat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.inLiuAll_nonCDS_enhancerShort_test_summitPlusMinus250bp.fa /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_mouseTest_summitPlusMinus250bp.fa /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/Liver_GoodReps/peak/idr_reproducibility/idr.optimal_peak_nonCDS_enhancerShort_mouseTest_summitPlusMinus250bp.fa > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.inLiuAll_nonCDS_enhancerShort_summitPlusMinus250bp_andMacaque_andRat_test.fa

# Get negative test set for brain
# Mouse
zcat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mm10_summitExtendedMin50Max2XProtect5_nonMouseBrain_andMacaque_andRat.narrowPeak.gz | grep -P 'chr1\t|chr2\t' | awk 'BEGIN{OFS="\t"} {print $1,$2+$10-250, $2+$10+250}' | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseGenome/mm10.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mm10_summitExtendedMin50Max2XProtect5_nonMouseBrain_andMacaque_andRat_test_summitPlusMinus250bp.fa
# Human
grep -P 'chr1\t|chr2\t' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort.bed > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test.bed
awk 'BEGIN{OFS="\t"} {print $1, $2+$10, $2+$10+1, $4}' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test.bed > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test_summits.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/hal/bin/halLiftover --bedType 4 /data/pfenninggroup/align/mam200/alignment_files/200m-v1.hal Mus_musculus /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test.bed Homo_sapiens /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test_hg38.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/hal/bin/halLiftover --bedType 4 /data/pfenninggroup/align/mam200/alignment_files/200m-v1.hal Mus_musculus /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test_summits.bed Homo_sapiens /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test_summits_hg38.bed
python /home/ikaplow/RegulatoryElementEvolutionProject/src/halLiftover-postprocessing/orthologFind.py -max_frac 2 -min_len 50 -protect_dist 5 -qFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test.bed -tFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test_hg38.bed -sFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test_summits_hg38.bed -oFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test_hg38_summitExtendedMin50Max2XProtect5.bed -narrowPeak
subtractBed -A -a /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test_hg38_summitExtendedMin50Max2XProtect5.bed -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-macs2_pooled/execution/SRR5367725_1.merged.nodup.tn5.pooled.pval0.01.300K.bfilt.narrowPeak.gz | subtractBed -A -a stdin -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/CaudatePutamen_DNase_out/out/peak/macs2/pooled_rep/Caudate_DNase.nodup_Putamen_DNase.nodup.pf.pval0.01.300K.filt.narrowPeak.gz | subtractBed -A -a stdin -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PUT/cromwell-executions/atac/cee5204e-3e9a-4437-868e-9fc8f05312af/call-macs2_pooled/execution/SRR5367726_1.merged.nodup.tn5.pooled.pval0.01.300K.bfilt.narrowPeak.gz | subtractBed -A -a stdin -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/NAC/cromwell-executions/atac/f47a76c2-4f55-458f-a1ac-08713d0f0608/call-macs2/shard-0/execution/SRR5367749_1.merged.nodup.tn5.pval0.01.300K.bfilt.narrowPeak.gz > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test_hg38_summitExtendedMin50Max2XProtect5_nonHumanBrain.bed
grep -P 'chr1\t|chr2\t' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatumLoose_nonCDS_enhancerShort_mm10_summitExtendedMin50Max2XProtect5.bed > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatumLoose_nonCDS_enhancerShort_mm10_summitExtendedMin50Max2XProtect5_mouseTest.bed
python /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/filterPeakName.py --unfilteredPeakFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatumLoose_nonCDS_enhancerShort_GenBankNames.bed --peakListFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatumLoose_nonCDS_enhancerShort_mm10_summitExtendedMin50Max2XProtect5_mouseTest.bed --peakNameCol 3 --outputFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatumLoose_nonCDS_enhancerShort_GenBankNames_mouseTest.bed
awk 'BEGIN{OFS="\t"} {print $1, $2+$10, $2+$10+1, $4}' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatumLoose_nonCDS_enhancerShort_GenBankNames_mouseTest.bed > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatumLoose_nonCDS_enhancerShort_GenBankNames_mouseTest_summits.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/hal/bin/halLiftover --bedType 4 /data/pfenninggroup/align/mam200/alignment_files/200m-v1.hal Macaca_mulatta /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatumLoose_nonCDS_enhancerShort_GenBankNames_mouseTest.bed Homo_sapiens /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatumLoose_nonCDS_enhancerShort_GenBankNames_mouseTest_hg38.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/hal/bin/halLiftover --bedType 4 /data/pfenninggroup/align/mam200/alignment_files/200m-v1.hal Macaca_mulatta /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatumLoose_nonCDS_enhancerShort_GenBankNames_mouseTest_summits.bed Homo_sapiens /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatumLoose_nonCDS_enhancerShort_GenBankNames_mouseTest_summits_hg38.bed
python /home/ikaplow/RegulatoryElementEvolutionProject/src/halLiftover-postprocessing/orthologFind.py -max_frac 2 -min_len 50 -protect_dist 5 -qFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatumLoose_nonCDS_enhancerShort_GenBankNames_mouseTest.bed -tFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatumLoose_nonCDS_enhancerShort_GenBankNames_mouseTest_hg38.bed -sFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatumLoose_nonCDS_enhancerShort_GenBankNames_mouseTest_summits_hg38.bed -oFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatumLoose_nonCDS_enhancerShort_GenBankNames_mouseTest_hg38_summitExtendedMin50Max2XProtect5.bed -narrowPeak
subtractBed -A -a /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatumLoose_nonCDS_enhancerShort_GenBankNames_mouseTest_hg38_summitExtendedMin50Max2XProtect5.bed -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-macs2_pooled/execution/SRR5367725_1.merged.nodup.tn5.pooled.pval0.01.300K.bfilt.narrowPeak.gz | subtractBed -A -a stdin -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/CaudatePutamen_DNase_out/out/peak/macs2/pooled_rep/Caudate_DNase.nodup_Putamen_DNase.nodup.pf.pval0.01.300K.filt.narrowPeak.gz | subtractBed -A -a stdin -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PUT/cromwell-executions/atac/cee5204e-3e9a-4437-868e-9fc8f05312af/call-macs2_pooled/execution/SRR5367726_1.merged.nodup.tn5.pooled.pval0.01.300K.bfilt.narrowPeak.gz | subtractBed -A -a stdin -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/NAC/cromwell-executions/atac/f47a76c2-4f55-458f-a1ac-08713d0f0608/call-macs2/shard-0/execution/SRR5367749_1.merged.nodup.tn5.pval0.01.300K.bfilt.narrowPeak.gz > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatumLoose_nonCDS_enhancerShort_GenBankNames_mouseTest_hg38_summitExtendedMin50Max2XProtect5_nonHumanBrain.bed
grep -P 'chr1\t|chr2\t' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mm10_summitExtendedMin50Max2XProtect5.bed > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mm10_summitExtendedMin50Max2XProtect5_mouseTest.bed
python /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/filterPeakName.py --unfilteredPeakFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatumLoose_nonCDS_enhancerShort.bed --peakListFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mm10_summitExtendedMin50Max2XProtect5_mouseTest.bed --peakNameCol 3 --outputFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest.bed
awk 'BEGIN{OFS="\t"} {print $1, $2+$10, $2+$10+1, $4}' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest.bed > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest_summits.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/hal/bin/halLiftover --bedType 4 /data/pfenninggroup/align/mam200/alignment_files/200m-v1.hal Rattus_norvegicus /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest.bed Homo_sapiens /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest_hg38.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/hal/bin/halLiftover --bedType 4 /data/pfenninggroup/align/mam200/alignment_files/200m-v1.hal Rattus_norvegicus /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest_summits.bed Homo_sapiens /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest_summits_hg38.bed
python /home/ikaplow/RegulatoryElementEvolutionProject/src/halLiftover-postprocessing/orthologFind.py -max_frac 2 -min_len 50 -protect_dist 5 -qFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest.bed -tFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseValid_hg38.bed -sFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest_summits_hg38.bed -oFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest_hg38_summitExtendedMin50Max2XProtect5.bed -narrowPeak
subtractBed -A -a /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest_hg38_summitExtendedMin50Max2XProtect5.bed -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-macs2_pooled/execution/SRR5367725_1.merged.nodup.tn5.pooled.pval0.01.300K.bfilt.narrowPeak.gz | subtractBed -A -a stdin -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/CaudatePutamen_DNase_out/out/peak/macs2/pooled_rep/Caudate_DNase.nodup_Putamen_DNase.nodup.pf.pval0.01.300K.filt.narrowPeak.gz | subtractBed -A -a stdin -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PUT/cromwell-executions/atac/cee5204e-3e9a-4437-868e-9fc8f05312af/call-macs2_pooled/execution/SRR5367726_1.merged.nodup.tn5.pooled.pval0.01.300K.bfilt.narrowPeak.gz | subtractBed -A -a stdin -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/NAC/cromwell-executions/atac/f47a76c2-4f55-458f-a1ac-08713d0f0608/call-macs2/shard-0/execution/SRR5367749_1.merged.nodup.tn5.pval0.01.300K.bfilt.narrowPeak.gz > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest_hg38_summitExtendedMin50Max2XProtect5_nonHumanBrain.bed
cat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test_hg38_summitExtendedMin50Max2XProtect5_nonHumanBrain.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatumLoose_nonCDS_enhancerShort_GenBankNames_mouseTest_hg38_summitExtendedMin50Max2XProtect5_nonHumanBrain.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest_hg38_summitExtendedMin50Max2XProtect5_nonHumanBrain.bed | sort -u -k1,1 -k2,2n -k3,3n -k10,10n | awk 'BEGIN{OFS="\t"} {print $1,$2+$10-250, $2+$10+250}' | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanGenome/hg38.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test_hg38_summitExtendedMin50Max2XProtect5_nonHumanBrain_andMacaque_andRat_summitPlusMinus250bp.fa
# Macaque
/home/ikaplow/RegulatoryElementEvolutionProject/src/hal/bin/halLiftover --bedType 4 /data/pfenninggroup/align/mam200/alignment_files/200m-v1.hal Mus_musculus /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test.bed Macaca_mulatta /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test_rheMac8.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/hal/bin/halLiftover --bedType 4 /data/pfenninggroup/align/mam200/alignment_files/200m-v1.hal Mus_musculus /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test_summits.bed Macaca_mulatta /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test_summits_rheMac8.bed
python /home/ikaplow/RegulatoryElementEvolutionProject/src/halLiftover-postprocessing/orthologFind.py -max_frac 2 -min_len 50 -protect_dist 5 -qFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test.bed -tFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test_rheMac8.bed -sFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test_summits_rheMac8.bed -oFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test_rheMac8_summitExtendedMin50Max2XProtect5.bed -narrowPeak
python /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/convertChromNames.py --bedFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test_rheMac8_summitExtendedMin50Max2XProtect5.bed --chromNameDictFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueGenome/GenbankNameToChromNameRheMac8.txt --outputFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test_rheMac8_summitExtendedMin50Max2XProtect5_UCSCNames.bed
subtractBed -A -a /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test_rheMac8_summitExtendedMin50Max2XProtect5_UCSCNames.bed -b /projects/MPRA/Irene/macaque/atac-pipeline-output/OfM/peak/pooled-rep/basename_prefix.pooled.pval0.01.300K.bfilt.narrowPeak.gz | subtractBed -A -a stdin -b /projects/MPRA/Irene/macaque/atac-pipeline-output/M1/peak/pooled-rep/basename_prefix.pooled.pval0.01.300K.bfilt.narrowPeak.gz | subtractBed -A -a stdin -b /projects/MPRA/Irene/macaque/atac-pipeline-output/StrP/peak/pooled-rep/basename_prefix.pooled.pval0.01.300K.bfilt.narrowPeak.gz | subtractBed -A -a stdin -b /projects/MPRA/Irene/macaque/atac-pipeline-output/StrC/peak/pooled-rep/basename_prefix.pooled.pval0.01.300K.bfilt.narrowPeak.gz | subtractBed -A -a stdin -b /projects/MPRA/macaque/atac-pipeline-output/Fiona/NAcc/call-macs2_pooled/execution/Mac1_NAcc_1_PFE116A26_S11_R1_001.merged.nodup.tn5.pooled.pval0.01.300K.bfilt.narrowPeak.gz > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test_rheMac8_summitExtendedMin50Max2XProtect5_UCSCNames_nonMacaqueBrain.bed
grep -P 'chr1\t|chr2\t' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mm10_summitExtendedMin50Max2XProtect5.bed > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mm10_summitExtendedMin50Max2XProtect5_mouseTest.bed
python /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/filterPeakName.py --unfilteredPeakFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatumLoose_nonCDS_enhancerShort.bed --peakListFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mm10_summitExtendedMin50Max2XProtect5_mouseTest.bed --peakNameCol 3 --outputFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest.bed
awk 'BEGIN{OFS="\t"} {print $1, $2+$10, $2+$10+1, $4}' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest.bed > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest_summits.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/hal/bin/halLiftover --bedType 4 /data/pfenninggroup/align/mam200/alignment_files/200m-v1.hal Homo_sapiens /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest.bed Macaca_mulatta /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest_rheMac8.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/hal/bin/halLiftover --bedType 4 /data/pfenninggroup/align/mam200/alignment_files/200m-v1.hal Homo_sapiens /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest_summits.bed Macaca_mulatta /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest_summits_rheMac8.bed
python /home/ikaplow/RegulatoryElementEvolutionProject/src/halLiftover-postprocessing/orthologFind.py -max_frac 2 -min_len 50 -protect_dist 5 -qFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest.bed -tFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest_rheMac8.bed -sFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest_summits_rheMac8.bed -oFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest_rheMac8_summitExtendedMin50Max2XProtect5.bed -narrowPeak
python /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/convertChromNames.py --bedFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest_rheMac8_summitExtendedMin50Max2XProtect5.bed --chromNameDictFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueGenome/GenbankNameToChromNameRheMac8.txt --outputFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest_rheMac8_summitExtendedMin50Max2XProtect5_UCSCNames.bed
subtractBed -A -a /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest_rheMac8_summitExtendedMin50Max2XProtect5_UCSCNames.bed -b /projects/MPRA/Irene/macaque/atac-pipeline-output/OfM/peak/pooled-rep/basename_prefix.pooled.pval0.01.300K.bfilt.narrowPeak.gz | subtractBed -A -a stdin -b /projects/MPRA/Irene/macaque/atac-pipeline-output/M1/peak/pooled-rep/basename_prefix.pooled.pval0.01.300K.bfilt.narrowPeak.gz | subtractBed -A -a stdin -b /projects/MPRA/Irene/macaque/atac-pipeline-output/StrP/peak/pooled-rep/basename_prefix.pooled.pval0.01.300K.bfilt.narrowPeak.gz | subtractBed -A -a stdin -b /projects/MPRA/Irene/macaque/atac-pipeline-output/StrC/peak/pooled-rep/basename_prefix.pooled.pval0.01.300K.bfilt.narrowPeak.gz | subtractBed -A -a stdin -b /projects/MPRA/macaque/atac-pipeline-output/Fiona/NAcc/call-macs2_pooled/execution/Mac1_NAcc_1_PFE116A26_S11_R1_001.merged.nodup.tn5.pooled.pval0.01.300K.bfilt.narrowPeak.gz > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest_rheMac8_summitExtendedMin50Max2XProtect5_UCSCNames_nonMacaqueBrain.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/hal/bin/halLiftover --bedType 4 /data/pfenninggroup/align/mam200/alignment_files/200m-v1.hal Rattus_norvegicus /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest.bed Macaca_mulatta /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest_rheMac8.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/hal/bin/halLiftover --bedType 4 /data/pfenninggroup/align/mam200/alignment_files/200m-v1.hal Rattus_norvegicus /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest_summits.bed Macaca_mulatta /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest_summits_rheMac8.bed
python /home/ikaplow/RegulatoryElementEvolutionProject/src/halLiftover-postprocessing/orthologFind.py -max_frac 2 -min_len 50 -protect_dist 5 -qFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest.bed -tFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest_rheMac8.bed -sFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest_summits_rheMac8.bed -oFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest_rheMac8_summitExtendedMin50Max2XProtect5.bed -narrowPeak
python /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/convertChromNames.py --bedFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest_rheMac8_summitExtendedMin50Max2XProtect5.bed --chromNameDictFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueGenome/GenbankNameToChromNameRheMac8.txt --outputFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest_rheMac8_summitExtendedMin50Max2XProtect5_UCSCNames.bed
subtractBed -A -a /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest_rheMac8_summitExtendedMin50Max2XProtect5_UCSCNames.bed -b /projects/MPRA/Irene/macaque/atac-pipeline-output/OfM/peak/pooled-rep/basename_prefix.pooled.pval0.01.300K.bfilt.narrowPeak.gz | subtractBed -A -a stdin -b /projects/MPRA/Irene/macaque/atac-pipeline-output/M1/peak/pooled-rep/basename_prefix.pooled.pval0.01.300K.bfilt.narrowPeak.gz | subtractBed -A -a stdin -b /projects/MPRA/Irene/macaque/atac-pipeline-output/StrP/peak/pooled-rep/basename_prefix.pooled.pval0.01.300K.bfilt.narrowPeak.gz | subtractBed -A -a stdin -b /projects/MPRA/Irene/macaque/atac-pipeline-output/StrC/peak/pooled-rep/basename_prefix.pooled.pval0.01.300K.bfilt.narrowPeak.gz | subtractBed -A -a stdin -b /projects/MPRA/macaque/atac-pipeline-output/Fiona/NAcc/call-macs2_pooled/execution/Mac1_NAcc_1_PFE116A26_S11_R1_001.merged.nodup.tn5.pooled.pval0.01.300K.bfilt.narrowPeak.gz > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest_rheMac8_summitExtendedMin50Max2XProtect5_UCSCNames_nonMacaqueBrain.bed
cat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test_rheMac8_summitExtendedMin50Max2XProtect5_UCSCNames_nonMacaqueBrain.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest_rheMac8_summitExtendedMin50Max2XProtect5_UCSCNames_nonMacaqueBrain.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest_rheMac8_summitExtendedMin50Max2XProtect5_UCSCNames_nonMacaqueBrain.bed | sort -u -k1,1 -k2,2n -k3,3n -k10,10n | awk 'BEGIN{OFS="\t"} {print $1,$2+$10-250, $2+$10+250}' | awk 'BEGIN{OFS="\t"} $2 >= 0' | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueGenome/rheMac8.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test_rheMac8_summitExtendedMin50Max2XProtect5_UCSCNames_nonMacaqueBrain_andHuman_andRat_summitPlusMinus250bp.fa
# Rat
/home/ikaplow/RegulatoryElementEvolutionProject/src/hal/bin/halLiftover --bedType 4 /data/pfenninggroup/align/mam200/alignment_files/200m-v1.hal Mus_musculus /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test.bed Rattus_norvegicus /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test_rn6.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/hal/bin/halLiftover --bedType 4 /data/pfenninggroup/align/mam200/alignment_files/200m-v1.hal Mus_musculus /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test_summits.bed Rattus_norvegicus /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test_summits_rn6.bed
python /home/ikaplow/RegulatoryElementEvolutionProject/src/halLiftover-postprocessing/orthologFind.py -max_frac 2 -min_len 50 -protect_dist 5 -qFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test.bed -tFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test_rn6.bed -sFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test_summits_rn6.bed -oFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test_rn6_summitExtendedMin50Max2XProtect5.bed -narrowPeak
subtractBed -A -a /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test_rn6_summitExtendedMin50Max2XProtect5.bed -b /projects/MPRA/Irene/rats/atac-pipeline-output/M1/peak/pooled-rep/basename_prefix.pooled.pval0.01.300K.bfilt.narrowPeak.gz | subtractBed -A -a stdin -b /projects/MPRA/Irene/rats/atac-pipeline-output/Striatum/atac/63d3a234-a3cd-494b-becb-967a8ed60a04/call-call_peak_pooled/execution/R2-Str_R1_001.trim.merged.nodup.no_chrM.tn5.pooled.pval0.01.300K.bfilt.narrowPeak.gz > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test_rn6_summitExtendedMin50Max2XProtect5_nonRatBrain.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/hal/bin/halLiftover --bedType 4 /data/pfenninggroup/align/mam200/alignment_files/200m-v1.hal Homo_sapiens /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest.bed Rattus_norvegicus /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest_rn6.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/hal/bin/halLiftover --bedType 4 /data/pfenninggroup/align/mam200/alignment_files/200m-v1.hal Homo_sapiens /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest_summits.bed Rattus_norvegicus /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest_summits_rn6.bed
python /home/ikaplow/RegulatoryElementEvolutionProject/src/halLiftover-postprocessing/orthologFind.py -max_frac 2 -min_len 50 -protect_dist 5 -qFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest.bed -tFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest_rn6.bed -sFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest_summits_rn6.bed -oFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest_rn6_summitExtendedMin50Max2XProtect5.bed -narrowPeak
subtractBed -A -a /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest_rn6_summitExtendedMin50Max2XProtect5.bed -b /projects/MPRA/Irene/rats/atac-pipeline-output/M1/peak/pooled-rep/basename_prefix.pooled.pval0.01.300K.bfilt.narrowPeak.gz | subtractBed -A -a stdin -b /projects/MPRA/Irene/rats/atac-pipeline-output/Striatum/atac/63d3a234-a3cd-494b-becb-967a8ed60a04/call-call_peak_pooled/execution/R2-Str_R1_001.trim.merged.nodup.no_chrM.tn5.pooled.pval0.01.300K.bfilt.narrowPeak.gz > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest_rn6_summitExtendedMin50Max2XProtect5_nonRatBrain.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/hal/bin/halLiftover --bedType 4 /data/pfenninggroup/align/mam200/alignment_files/200m-v1.hal Macaca_mulatta /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatumLoose_nonCDS_enhancerShort_GenBankNames_mouseTest.bed Rattus_norvegicus /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatumLoose_nonCDS_enhancerShort_GenBankNames_mouseTest_rn6.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/hal/bin/halLiftover --bedType 4 /data/pfenninggroup/align/mam200/alignment_files/200m-v1.hal Macaca_mulatta /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatumLoose_nonCDS_enhancerShort_GenBankNames_mouseTest_summits.bed Rattus_norvegicus /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatumLoose_nonCDS_enhancerShort_GenBankNames_mouseTest_summits_rn6.bed
python /home/ikaplow/RegulatoryElementEvolutionProject/src/halLiftover-postprocessing/orthologFind.py -max_frac 2 -min_len 50 -protect_dist 5 -qFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatumLoose_nonCDS_enhancerShort_GenBankNames_mouseTest.bed -tFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatumLoose_nonCDS_enhancerShort_GenBankNames_mouseTest_rn6.bed -sFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatumLoose_nonCDS_enhancerShort_GenBankNames_mouseTest_summits_rn6.bed -oFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatumLoose_nonCDS_enhancerShort_GenBankNames_mouseTest_rn6_summitExtendedMin50Max2XProtect5.bed -narrowPeak
subtractBed -A -a /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatumLoose_nonCDS_enhancerShort_GenBankNames_mouseTest_rn6_summitExtendedMin50Max2XProtect5.bed -b /projects/MPRA/Irene/rats/atac-pipeline-output/M1/peak/pooled-rep/basename_prefix.pooled.pval0.01.300K.bfilt.narrowPeak.gz | subtractBed -A -a stdin -b /projects/MPRA/Irene/rats/atac-pipeline-output/Striatum/atac/63d3a234-a3cd-494b-becb-967a8ed60a04/call-call_peak_pooled/execution/R2-Str_R1_001.trim.merged.nodup.no_chrM.tn5.pooled.pval0.01.300K.bfilt.narrowPeak.gz > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatumLoose_nonCDS_enhancerShort_GenBankNames_mouseTest_rn6_summitExtendedMin50Max2XProtect5_nonRatBrain.bed
cat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test_rn6_summitExtendedMin50Max2XProtect5_nonRatBrain.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mouseTest_rn6_summitExtendedMin50Max2XProtect5_nonRatBrain.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatumLoose_nonCDS_enhancerShort_GenBankNames_mouseTest_rn6_summitExtendedMin50Max2XProtect5_nonRatBrain.bed | sort -u -k1,1 -k2,2n -k3,3n -k10,10n | awk 'BEGIN{OFS="\t"} {print $1,$2+$10-250, $2+$10+250}' | awk 'BEGIN{OFS="\t"} $2 >= 0' | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatGenome/rn6.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test_rn6_summitExtendedMin50Max2XProtect5_nonRatBrain_andHuman_andMacaque_summitPlusMinus250bp.fa
# Combine
cat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mm10_summitExtendedMin50Max2XProtect5_nonMouseBrain_andMacaque_andRat_test_summitPlusMinus250bp.fa /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test_hg38_summitExtendedMin50Max2XProtect5_nonHumanBrain_andMacaque_andRat_summitPlusMinus250bp.fa /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test_rheMac8_summitExtendedMin50Max2XProtect5_UCSCNames_nonMacaqueBrain_andHuman_andRat_summitPlusMinus250bp.fa /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeCAndStriatumLoose_nonCDS_enhancerShort_test_rn6_summitExtendedMin50Max2XProtect5_nonRatBrain_andHuman_andMacaque_summitPlusMinus250bp.fa > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mm10_summitExtendedMin50Max2XProtect5_nonMouseBrain_andMacaque_andRat_test_summitPlusMinus250bp_andHumanNeg_andMacaqueNeg_andRatNeg.fa

# Get negative test set for liver
# Mouse
python /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/filterPeakName.py --unfilteredPeakFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_withPeakNames_GenBankNames_mm10Huge_summitExtendedMin50Max2Protect5_test.bed --unfilteredPeakNameCol 4 --peakListFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_mouseTest.bed --peakNameCol 3 --outputFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_mm10Huge_summitExtendedMin50Max2Protect5_test.bed
subtractBed -A -a /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_mm10Huge_summitExtendedMin50Max2Protect5_test.bed -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-call_peak_pooled/execution/AP462Liv_CKDL190142778-1a-N702-N508_HMHTYDSXX_L2_1.trim.merged.nodup.no_chrM.tn5.pooled.pval0.01.300K.bfilt.narrowPeak.gz | subtractBed -A -a stdin -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverAllLiu_ATAC_out/atac/ac63679d-3e9b-45e7-8fa5-b7b221cb6aaa/peak/pooled-rep/Male_Liver_Rep1_1.merged.nodup.tn5.pooled.pval0.01.300K.bfilt.narrowPeak.gz | awk 'BEGIN{OFS="\t"}{print $1,$2,$3,$5,0,".",-1,-1,-1,$8}' > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_mm10Huge_summitExtendedMin50Max2Protect5_test_nonMouseLiver.bed
cat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_mm10Huge_summitExtendedMin50Max2Protect5_test_nonMouseLiver.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/Liver_GoodReps/peak/idr_reproducibility/idr.optimal_peak_nonCDS_enhancerShort_mm10_summitExtendedMin50Max2XProtect5_nonMouseLiver_mouseTest.bed | sort -u -k1,1 -k2,2n -k3,3n -k10,10n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_mm10Huge_summitExtendedMin50Max2Protect5_test_nonMouseLiver_andRat.bed
awk 'BEGIN{OFS="\t"} {print $1,$2+$10-250, $2+$10+250}' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_mm10Huge_summitExtendedMin50Max2Protect5_test_nonMouseLiver_andRat.bed | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseGenome/mm10.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_mm10Huge_summitExtendedMin50Max2Protect5_test_nonMouseLiver_andRat_summitPlusMinus250bp.fa
# Macaque
grep -P 'chr1\t|chr2\t' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.inLiuAllLoose_nonCDS_enhancerShort.bed > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.inLiuAllLoose_nonCDS_enhancerShort_test.bed
awk 'BEGIN{OFS="\t"} {print $1, $2+$10, $2+$10+1, $4}' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.inLiuAllLoose_nonCDS_enhancerShort_test.bed > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.inLiuAllLoose_nonCDS_enhancerShort_test_summits.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/hal/bin/halLiftover --bedType 4 /data/pfenninggroup/align/mam200/alignment_files/200m-v1.hal Mus_musculus /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.inLiuAllLoose_nonCDS_enhancerShort_test.bed Macaca_mulatta /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.inLiuAllLoose_nonCDS_enhancerShort_test_rheMac8.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/hal/bin/halLiftover --bedType 4 /data/pfenninggroup/align/mam200/alignment_files/200m-v1.hal Mus_musculus /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.inLiuAllLoose_nonCDS_enhancerShort_test_summits.bed Macaca_mulatta /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.inLiuAllLoose_nonCDS_enhancerShort_test_summits_rheMac8.bed
python /home/ikaplow/RegulatoryElementEvolutionProject/src/halLiftover-postprocessing/orthologFind.py -max_frac 2 -min_len 50 -protect_dist 5 -qFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.inLiuAllLoose_nonCDS_enhancerShort_test.bed -tFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.inLiuAllLoose_nonCDS_enhancerShort_test_rheMac8.bed -sFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.inLiuAllLoose_nonCDS_enhancerShort_test_summits_rheMac8.bed -oFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.inLiuAllLoose_nonCDS_enhancerShort_test_rheMac8_summitExtendedMin50Max2XProtect5.bed -narrowPeak
python /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/convertChromNames.py --bedFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.inLiuAllLoose_nonCDS_enhancerShort_test_rheMac8_summitExtendedMin50Max2XProtect5.bed --chromNameDictFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueGenome/GenbankNameToChromNameRheMac8.txt --outputFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.inLiuAllLoose_nonCDS_enhancerShort_test_rheMac8_summitExtendedMin50Max2XProtect5_UCSCNames.bed
subtractBed -A -a /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.inLiuAllLoose_nonCDS_enhancerShort_test_rheMac8_summitExtendedMin50Max2XProtect5_UCSCNames.bed -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-macs2_pooled/execution/Mac1_Lv_1_PFE116A29_S8_R1_001.merged.nodup.tn5.pooled.pval0.01.300K.bfilt.narrowPeak.gz > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.inLiuAllLoose_nonCDS_enhancerShort_test_rheMac8_summitExtendedMin50Max2XProtect5_UCSCNames_nonMacaqueLiver.bed
awk 'BEGIN{OFS="\t"} {print $1, $2+$10, $2+$10+1, $4}' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/Liver_GoodReps/peak/idr_reproducibility/idr.optimal_peak_nonCDS_enhancerShort_mouseTest.bed > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/Liver_GoodReps/peak/idr_reproducibility/idr.optimal_peak_nonCDS_enhancerShort_mouseTest_summits.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/hal/bin/halLiftover --bedType 4 /data/pfenninggroup/align/mam200/alignment_files/200m-v1.hal Rattus_norvegicus /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/Liver_GoodReps/peak/idr_reproducibility/idr.optimal_peak_nonCDS_enhancerShort_mouseTest.bed Macaca_mulatta /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/Liver_GoodReps/peak/idr_reproducibility/idr.optimal_peak_nonCDS_enhancerShort_mouseTest_rheMac8.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/hal/bin/halLiftover --bedType 4 /data/pfenninggroup/align/mam200/alignment_files/200m-v1.hal Rattus_norvegicus /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/Liver_GoodReps/peak/idr_reproducibility/idr.optimal_peak_nonCDS_enhancerShort_mouseTest_summits.bed Macaca_mulatta /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/Liver_GoodReps/peak/idr_reproducibility/idr.optimal_peak_nonCDS_enhancerShort_mouseTest_summits_rheMac8.bed
python /home/ikaplow/RegulatoryElementEvolutionProject/src/halLiftover-postprocessing/orthologFind.py -max_frac 2 -min_len 50 -protect_dist 5 -qFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/Liver_GoodReps/peak/idr_reproducibility/idr.optimal_peak_nonCDS_enhancerShort_mouseTest.bed -tFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/Liver_GoodReps/peak/idr_reproducibility/idr.optimal_peak_nonCDS_enhancerShort_mouseTest_rheMac8.bed -sFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/Liver_GoodReps/peak/idr_reproducibility/idr.optimal_peak_nonCDS_enhancerShort_mouseTest_summits_rheMac8.bed -oFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/Liver_GoodReps/peak/idr_reproducibility/idr.optimal_peak_nonCDS_enhancerShort_mouseTest_rheMac8_summitExtendedMin50Max2XProtect5.bed
python /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/convertChromNames.py --bedFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/Liver_GoodReps/peak/idr_reproducibility/idr.optimal_peak_nonCDS_enhancerShort_mouseTest_rheMac8_summitExtendedMin50Max2XProtect5.bed --chromNameDictFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueGenome/GenbankNameToChromNameRheMac8.txt --outputFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/Liver_GoodReps/peak/idr_reproducibility/idr.optimal_peak_nonCDS_enhancerShort_mouseTest_rheMac8_summitExtendedMin50Max2XProtect5_UCSCNames.bed
subtractBed -A -a /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/Liver_GoodReps/peak/idr_reproducibility/idr.optimal_peak_nonCDS_enhancerShort_mouseTest_rheMac8_summitExtendedMin50Max2XProtect5_UCSCNames.bed -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-macs2_pooled/execution/Mac1_Lv_1_PFE116A29_S8_R1_001.merged.nodup.tn5.pooled.pval0.01.300K.bfilt.narrowPeak.gz > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/Liver_GoodReps/peak/idr_reproducibility/idr.optimal_peak_nonCDS_enhancerShort_mouseTest_rheMac8_summitExtendedMin50Max2XProtect5_UCSCNames_nonMacaqueLiver.bed
cat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.inLiuAllLoose_nonCDS_enhancerShort_test_rheMac8_summitExtendedMin50Max2XProtect5_UCSCNames_nonMacaqueLiver.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/Liver_GoodReps/peak/idr_reproducibility/idr.optimal_peak_nonCDS_enhancerShort_mouseTest_rheMac8_summitExtendedMin50Max2XProtect5_UCSCNames_nonMacaqueLiver.bed | sort -u -k1,1 -k2,2n -k3,3n -k10,10n | awk 'BEGIN{OFS="\t"} {print $1,$2+$10-250, $2+$10+250}' | awk 'BEGIN{OFS="\t"} $2>0' | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueGenome/rheMac8.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.inLiuAllLoose_nonCDS_enhancerShort_test_rheMac8_summitExtendedMin50Max2XProtect5_UCSCNames_nonMacaqueLiver_andRat_summitPlusMinus250bp.fa
# Rat
/home/ikaplow/RegulatoryElementEvolutionProject/src/hal/bin/halLiftover --bedType 4 /data/pfenninggroup/align/mam200/alignment_files/200m-v1.hal Mus_musculus /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.inLiuAllLoose_nonCDS_enhancerShort_test.bed Rattus_norvegicus /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.inLiuAllLoose_nonCDS_enhancerShort_test_rn6.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/hal/bin/halLiftover --bedType 4 /data/pfenninggroup/align/mam200/alignment_files/200m-v1.hal Mus_musculus /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.inLiuAllLoose_nonCDS_enhancerShort_test_summits.bed Rattus_norvegicus /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.inLiuAllLoose_nonCDS_enhancerShort_test_summits_rn6.bed
python /home/ikaplow/RegulatoryElementEvolutionProject/src/halLiftover-postprocessing/orthologFind.py -max_frac 2 -min_len 50 -protect_dist 5 -qFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.inLiuAllLoose_nonCDS_enhancerShort_test.bed -tFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.inLiuAllLoose_nonCDS_enhancerShort_test_rn6.bed -sFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.inLiuAllLoose_nonCDS_enhancerShort_test_summits_rn6.bed -oFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.inLiuAllLoose_nonCDS_enhancerShort_test_rn6_summitExtendedMin50Max2XProtect5.bed -narrowPeak
subtractBed -A -a /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.inLiuAllLoose_nonCDS_enhancerShort_test_rn6_summitExtendedMin50Max2XProtect5.bed -b /projects/MPRA/Irene/rats/atac-pipeline-output/Liver/peak/pooled-rep/R2-Liv_R1_001.trim.merged.nodup.no_chrM.tn5.pooled.pval0.01.300K.bfilt.narrowPeak.gz > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.inLiuAllLoose_nonCDS_enhancerShort_test_rn6_summitExtendedMin50Max2XProtect5_nonRatLiver.bed
python /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/convertChromNames.py --bedFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_mouseTest.bed --chromNameDictFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueGenome/GenbankNameToChromNameRheMac8.txt --chromNameDictReverse --outputFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_mouseTest_GenBankNames.bed
awk 'BEGIN{OFS="\t"} {print $1, $2+$10, $2+$10+1, $4}' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_mouseTest_GenBankNames.bed > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_mouseTest_GenBankNames_summits.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/hal/bin/halLiftover --bedType 4 /data/pfenninggroup/align/mam200/alignment_files/200m-v1.hal Macaca_mulatta /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_mouseTest_GenBankNames.bed Rattus_norvegicus /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_mouseTest_rn6.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/hal/bin/halLiftover --bedType 4 /data/pfenninggroup/align/mam200/alignment_files/200m-v1.hal Macaca_mulatta /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_mouseTest_GenBankNames_summits.bed Rattus_norvegicus /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_mouseTest_summits_rn6.bed
python /home/ikaplow/RegulatoryElementEvolutionProject/src/halLiftover-postprocessing/orthologFind.py -max_frac 2 -min_len 50 -protect_dist 5 -qFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_mouseTest_GenBankNames.bed -tFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_mouseTest_rn6.bed -sFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_mouseTest_summits_rn6.bed -oFile /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_mouseTest_rn6_summitExtendedMin50Max2XProtect5.bed -narrowPeak
subtractBed -A -a /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_mouseTest_rn6_summitExtendedMin50Max2XProtect5.bed -b /projects/MPRA/Irene/rats/atac-pipeline-output/Liver/peak/pooled-rep/R2-Liv_R1_001.trim.merged.nodup.no_chrM.tn5.pooled.pval0.01.300K.bfilt.narrowPeak.gz > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_mouseTest_rn6_summitExtendedMin50Max2XProtect5_nonRatLiver.bed
cat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.inLiuAllLoose_nonCDS_enhancerShort_test_rn6_summitExtendedMin50Max2XProtect5_nonRatLiver.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_mouseTest_rn6_summitExtendedMin50Max2XProtect5_nonRatLiver.bed | sort -u -k1,1 -k2,2n -k3,3n -k10,10n | awk 'BEGIN{OFS="\t"} {print $1,$2+$10-250, $2+$10+250}' | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatGenome/rn6.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.inLiuAllLoose_nonCDS_enhancerShort_test_rn6_summitExtendedMin50Max2XProtect5_nonRatLiver_andMacaque_summitPlusMinus250bp.fa
# Combine
cat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_mm10Huge_summitExtendedMin50Max2Protect5_test_nonMouseLiver_andRat_summitPlusMinus250bp.fa /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.inLiuAllLoose_nonCDS_enhancerShort_test_rheMac8_summitExtendedMin50Max2XProtect5_UCSCNames_nonMacaqueLiver_andRat_summitPlusMinus250bp.fa /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.inLiuAllLoose_nonCDS_enhancerShort_test_rn6_summitExtendedMin50Max2XProtect5_nonRatLiver_andMacaque_summitPlusMinus250bp.fa > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_mm10Huge_summitExtendedMin50Max2Protect5_test_nonMouseLiver_andRat_summitPlusMinus250bp_andMacaqueNeg_andRatNeg.fa

# Get non-restrictive clade-specific enhancers for brain test set
# Non-restrictive glires-specific brain enhancers
zcat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_inRatBrainLoose_nonHumanBrain_nonMacaqueBrain.bed.gz | grep -P 'chr1\t|chr2\t' | awk 'BEGIN{OFS="\t"} {print $1,$2+$10-250, $2+$10+250}' | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseGenome/mm10.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_inRatBrainLoose_nonHumanBrain_nonMacaqueBrain_test_summitPlusMinus250bp.fa
# Non-restrictive euarchonta-specific brain enhancers
python /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/filterPeakName.py --unfilteredPeakFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatum_nonCDS_enhancerShort_inMacaqueBrainLoose_nonMouseBrain_nonRatBrain.bed --peakListFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatum_nonCDS_enhancerShort_mouseTest.bed --peakNameCol 3 --outputFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatum_nonCDS_enhancerShort_inMacaqueBrainLoose_nonMouseBrain_nonRatBrain_mouseTest.bed
awk 'BEGIN{OFS="\t"} {print $1,$2+$10-250, $2+$10+250}' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatum_nonCDS_enhancerShort_inMacaqueBrainLoose_nonMouseBrain_nonRatBrain_mouseTest.bed | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanGenome/hg38.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatum_nonCDS_enhancerShort_inMacaqueBrainLoose_nonMouseBrain_nonRatBrain_mouseTest_summitPlusMinus250bp.fa
# Combine
cat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_inRatBrainLoose_nonHumanBrain_nonMacaqueBrain_test_summitPlusMinus250bp.fa /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatum_nonCDS_enhancerShort_inMacaqueBrainLoose_nonMouseBrain_nonRatBrain_mouseTest_summitPlusMinus250bp.fa > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_inRatBrainLoose_nonHumanBrain_nonMacaqueBrain_test_summitPlusMinus250bp_andEuarchontaSpecificLoose.fa

# Get non-restrictive clade-specific enhancers for liver test set
# Non-restrictive glires-specific liver enhancers
zcat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_inRatLiverLoose_nonMacaqueLiver.bed.gz | grep -P 'chr1\t|chr2\t' | awk 'BEGIN{OFS="\t"} {print $1,$2+$10-250, $2+$10+250}' | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseGenome/mm10.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_inRatLiverLoose_nonMacaqueLiver_test_summitPlusMinus250bp.fa
# Euarchonta-specific liver enhancers
python /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/filterPeakName.py --unfilteredPeakFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort.bed --peakListFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_mm10Huge_summitExtendedMin50Max2Protect5_nonMouseLiver_nonRatLiver_mouseTest.bed --peakNameCol 3 --outputFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_nonMouseLiver_nonRatLiver_mouseTest.bed
awk 'BEGIN{OFS="\t"} {print $1,$2+$10-250, $2+$10+250}' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_nonMouseLiver_nonRatLiver_mouseTest.bed | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueGenome/rheMac8.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_nonMouseLiver_nonRatLiver_mouseTest_summitPlusMinus250bp.fa
# Combine
cat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_inRatLiverLoose_nonMacaqueLiver_test_summitPlusMinus250bp.fa /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_nonMouseLiver_nonRatLiver_mouseTest_summitPlusMinus250bp.fa > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_inRatLiverLoose_nonMacaqueLiver_test_summitPlusMinus250bp_andEuarchontaSpecific.fa

# Get non-restrictive clade-specific non-enhancers for brain test set
# Non-restrictive glires-specific brain non-enhancers
zcat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatum_nonCDS_enhancerShort_mm10_summitExtendedMin50Max2XProtect5_inMacaqueBrainLoose_nonMouseBrain_nonRatBrain.bed.gz | grep -P 'chr1\t|chr2\t' | awk 'BEGIN{OFS="\t"} {print $1,$2+$10-250, $2+$10+250}' | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseGenome/mm10.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatum_nonCDS_enhancerShort_mm10_summitExtendedMin50Max2XProtect5_inMacaqueBrainLoose_nonMouseBrain_nonRatBrain_test_summitPlusMinus250bp.fa
# Non-restrictive euarchonta-specific brain non-enhancers
python /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/filterPeakName.py --unfilteredPeakFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_withPeakNames_hg38Huge_summitExtendedMin50Max2Protect5_mouseTest.bed --unfilteredPeakNameCol 3 --peakListFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_inRatBrainLoose_nonHumanBrain_nonMacaqueBrain.bed.gz --peakNameCol 3 --outputFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_withPeakNames_hg38Huge_summitExtendedMin50Max2Protect5_mouseTest_inRatBrainLoose_nonHumanBrain_nonMacaqueBrain.bed
awk 'BEGIN{OFS="\t"} {print $1,$2+$10-250, $2+$10+250}' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_withPeakNames_hg38Huge_summitExtendedMin50Max2Protect5_mouseTest_inRatBrainLoose_nonHumanBrain_nonMacaqueBrain.bed | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanGenome/hg38.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_withPeakNames_hg38Huge_summitExtendedMin50Max2Protect5_mouseTest_inRatBrainLoose_nonHumanBrain_nonMacaqueBrain_summitPlusMinus250bp.fa
# Combine
cat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatum_nonCDS_enhancerShort_mm10_summitExtendedMin50Max2XProtect5_inMacaqueBrainLoose_nonMouseBrain_nonRatBrain_test_summitPlusMinus250bp.fa /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_withPeakNames_hg38Huge_summitExtendedMin50Max2Protect5_mouseTest_inRatBrainLoose_nonHumanBrain_nonMacaqueBrain_summitPlusMinus250bp.fa > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatum_nonCDS_enhancerShort_mm10_summitExtendedMin50Max2XProtect5_inMacaqueBrainLoose_nonMouseBrain_nonRatBrain_test_summitPlusMinus250bp_andEuarchontaSpecificNonEnhLoose.fa

# Get non-restrictive clade-specific non-enhancers for liver test set
# Glires-specific liver non-enhancers
awk 'BEGIN{OFS="\t"} {print $1,$2+$10-250, $2+$10+250}' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_mm10Huge_summitExtendedMin50Max2Protect5_nonMouseLiver_nonRatLiver_mouseTest.bed | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseGenome/mm10.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_mm10Huge_summitExtendedMin50Max2Protect5_nonMouseLiver_nonRatLiver_mouseTest_summitPlusMinus250bp.fa
# Non-restrictive euarchonta-specific liver non-enhancers
zcat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_rheMac8_summitExtendedMin50Max2XProtect5_UCSCNames_nonMacaqueLiver_inRatLiverLoose_mouseTest.bed.gz | awk 'BEGIN{OFS="\t"} {print $1,$2+$10-250, $2+$10+250}' | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueGenome/rheMac8.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_rheMac8_summitExtendedMin50Max2XProtect5_UCSCNames_nonMacaqueLiver_inRatLiverLoose_mouseTest_summitPlusMinus250bp.fa
# Combine
cat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_mm10Huge_summitExtendedMin50Max2Protect5_nonMouseLiver_nonRatLiver_mouseTest_summitPlusMinus250bp.fa /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_rheMac8_summitExtendedMin50Max2XProtect5_UCSCNames_nonMacaqueLiver_inRatLiverLoose_mouseTest_summitPlusMinus250bp.fa > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_mm10Huge_summitExtendedMin50Max2Protect5_nonMouseLiver_nonRatLiver_mouseTest_summitPlusMinus250bp_andEuarchontaSpecificNonEnhLoose.fa

# Get non-restrictive species-specific enhancers for brain test set
# Non-restrictive mouse-specific enhancers
grep -P 'chr1\t|chr2\t' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_withPeakNames_nonRatBrain.bed | awk 'BEGIN{OFS="\t"} {print $1,$2+$10-250, $2+$10+250}' | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseGenome/mm10.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_withPeakNames_nonRatBrain_mouseTest_summitPlusMinus250bp.fa
# Non-restrictive human-specific enhancers
zcat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatum_nonCDS_enhancerShort_nonMacaqueBrain_mouseTest.bed.gz | awk 'BEGIN{OFS="\t"} {print $1,$2+$10-250, $2+$10+250}' | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanGenome/hg38.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatum_nonCDS_enhancerShort_nonMacaqueBrain_mouseTest_summitPlusMinus250bp.fa
# Non-restrictive macaque-specific enhancers
zcat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatum_nonCDS_enhancerShort_nonHumanBrain_mouseTest.bed.gz | awk 'BEGIN{OFS="\t"} {print $1,$2+$10-250, $2+$10+250}' | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueGenome/rheMac8.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatum_nonCDS_enhancerShort_nonHumanBrain_mouseTest_summitPlusMinus250bp.fa
# Non-restrictive rat-specific enhancers
zcat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatum_nonCDS_enhancerShort_mouseTest_nonMouseBrain.bed.gz | awk 'BEGIN{OFS="\t"} {print $1,$2+$10-250, $2+$10+250}' | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatGenome/rn6.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatum_nonCDS_enhancerShort_mouseTest_nonMouseBrain_summitPlusMinus250bp.fa
# Combine
cat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_withPeakNames_nonRatBrain_mouseTest_summitPlusMinus250bp.fa /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatum_nonCDS_enhancerShort_nonMacaqueBrain_mouseTest_summitPlusMinus250bp.fa /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatum_nonCDS_enhancerShort_nonHumanBrain_mouseTest_summitPlusMinus250bp.fa /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatum_nonCDS_enhancerShort_mouseTest_nonMouseBrain_summitPlusMinus250bp.fa > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_withPeakNames_nonRatBrain_mouseTest_summitPlusMinus250bp_andHumanSpecificLoose_andMacaqueSpecificLoose_andRatSpecificLoose.fa

# Get non-restrictive species-specific enhancers for liver test set
# Non-restrictive mouse-specific enhancers
grep -P 'chr1\t|chr2\t' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_nonRatLiver.bed.gz | awk 'BEGIN{OFS="\t"} {print $1,$2+$10-250, $2+$10+250}' | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseGenome/mm10.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_nonRatLiver_test_summitPlusMinus250bp.fa
# Non-restrictive rat-specific enhancers
zcat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/Liver_GoodReps/peak/idr_reproducibility/idr.optimal_peak_nonCDS_enhancerShort_nonMouseLiver_mouseTest.bed.gz | awk 'BEGIN{OFS="\t"} {print $1,$2+$10-250, $2+$10+250}' | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatGenome/rn6.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/Liver_GoodReps/peak/idr_reproducibility/idr.optimal_peak_nonCDS_enhancerShort_nonMouseLiver_mouseTest_summitPlusMinus250bp.fa
# Combine
cat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_nonRatLiver_test_summitPlusMinus250bp.fa /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/Liver_GoodReps/peak/idr_reproducibility/idr.optimal_peak_nonCDS_enhancerShort_nonMouseLiver_mouseTest_summitPlusMinus250bp.fa > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_nonRatLiver_test_summitPlusMinus250bp_andRatSpecificLoose.fa

# Get non-restrictive species-specific non-enhancers for brain test set
# Non-restrictive mouse-specific non-enhancers
grep -P 'chr1\t|chr2\t' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatum_nonCDS_enhancerShort_mm10_summitExtendedMin50Max2XProtect5_nonMouseBrain.bed | awk 'BEGIN{OFS="\t"} {print $1,$2+$10-250, $2+$10+250}' | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseGenome/mm10.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatum_nonCDS_enhancerShort_mm10_summitExtendedMin50Max2XProtect5_nonMouseBrain_mouseTest_summitPlusMinus250bp.fa
# Non-restrictive human-specific non-enhancers
zcat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatum_nonCDS_enhancerShort_hg38_summitExtendedMin50Max2XProtect5_nonHumanBrain_mouseTest.bed.gz | awk 'BEGIN{OFS="\t"} {print $1,$2+$10-250, $2+$10+250}' | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanGenome/hg38.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatum_nonCDS_enhancerShort_hg38_summitExtendedMin50Max2XProtect5_nonHumanBrain_mouseTest_summitPlusMinus250bp.fa
# Non-restrictive macaque-specific non-enhancers
zcat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatum_nonCDS_enhancerShort_rheMac8_summitExtendedMin50Max2XProtect5_UCSCNames_nonMacaqueBrain_mouseTest.bed.gz | awk 'BEGIN{OFS="\t"} {print $1,$2+$10-250, $2+$10+250}' | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueGenome/rheMac8.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatum_nonCDS_enhancerShort_rheMac8_summitExtendedMin50Max2XProtect5_UCSCNames_nonMacaqueBrain_mouseTest_summitPlusMinus250bp.fa
# Non-restrictive rat-specific non-enhancers
zcat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_withPeakNames_rn6Huge_summitExtendedMin50Max2Protect5_nonRatBrain_mouseTest.bed.gz | awk 'BEGIN{OFS="\t"} {print $1,$2+$10-250, $2+$10+250}' | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatGenome/rn6.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_withPeakNames_rn6Huge_summitExtendedMin50Max2Protect5_nonRatBrain_mouseTest_summitPlusMinus250bp.fa
# Combine
cat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatum_nonCDS_enhancerShort_mm10_summitExtendedMin50Max2XProtect5_nonMouseBrain_mouseTest_summitPlusMinus250bp.fa /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatum_nonCDS_enhancerShort_hg38_summitExtendedMin50Max2XProtect5_nonHumanBrain_mouseTest_summitPlusMinus250bp.fa /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatum_nonCDS_enhancerShort_rheMac8_summitExtendedMin50Max2XProtect5_UCSCNames_nonMacaqueBrain_mouseTest_summitPlusMinus250bp.fa /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_withPeakNames_rn6Huge_summitExtendedMin50Max2Protect5_nonRatBrain_mouseTest_summitPlusMinus250bp.fa > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatum_nonCDS_enhancerShort_mm10_summitExtendedMin50Max2XProtect5_nonMouseBrain_mouseTest_summitPlusMinus250bp_andHumanSpecificNonEnhLoose_andMacaqueSpecificNonEnhLoose_andRatSpecificNonEnhLoose.fa

# Get non-restrictive species-specific non-enhancers for liver test set
# Non-restrictive mouse-specific non-enhancers
awk 'BEGIN{OFS="\t"} {print $1,$2+$10-250, $2+$10+250}' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/Liver_GoodReps/peak/idr_reproducibility/idr.optimal_peak_nonCDS_enhancerShort_mm10_summitExtendedMin50Max2XProtect5_nonMouseLiver_mouseTest.bed | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseGenome/mm10.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/Liver_GoodReps/peak/idr_reproducibility/idr.optimal_peak_nonCDS_enhancerShort_mm10_summitExtendedMin50Max2XProtect5_nonMouseLiver_mouseTest_summitPlusMinus250bp.fa
# Non-restrictive rat-specific non-enhancers
zcat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_rn6_summitExtendedMin50Max2XProtect5_nonRatLiver_mouseTest.bed.gz | awk 'BEGIN{OFS="\t"} {print $1,$2+$10-250, $2+$10+250}' | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatGenome/rn6.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_rn6_summitExtendedMin50Max2XProtect5_nonRatLiver_mouseTest_summitPlusMinus250bp.fa
# Combine
cat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/Liver_GoodReps/peak/idr_reproducibility/idr.optimal_peak_nonCDS_enhancerShort_mm10_summitExtendedMin50Max2XProtect5_nonMouseLiver_mouseTest_summitPlusMinus250bp.fa /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_rn6_summitExtendedMin50Max2XProtect5_nonRatLiver_mouseTest_summitPlusMinus250bp.fa > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/Liver_GoodReps/peak/idr_reproducibility/idr.optimal_peak_nonCDS_enhancerShort_mm10_summitExtendedMin50Max2XProtect5_nonMouseLiver_mouseTest_summitPlusMinus250bp_andRatSpecificNonEnhLoose.fa

# Get shared brain and liver enhancers for brain test set
# Mouse
zcat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_andLiverLiuPfenning.narrowPeak.gz | grep -P 'chr1\t|chr2\t' | awk 'BEGIN{OFS="\t"} {print $1,$2+$10-250, $2+$10+250}' | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseGenome/mm10.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_andLiverLiuPfenning_test_summitPlusMinus250bp.fa
# Macaque
zcat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatum_nonCDS_enhancerShort_andLiver_mouseTest.bed.gz | awk 'BEGIN{OFS="\t"} {print $1,$2+$10-250, $2+$10+250}' | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueGenome/rheMac8.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatum_nonCDS_enhancerShort_andLiver_mouseTest_summitPlusMinus250bp.fa
# Rat
zcat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatum_nonCDS_enhancerShort_andLiver_mouseTest.bed.gz | awk 'BEGIN{OFS="\t"} {print $1,$2+$10-250, $2+$10+250}' | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatGenome/rn6.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatum_nonCDS_enhancerShort_andLiver_mouseTest_summitPlusMinus250bp.fa
# Combine
cat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_andLiverLiuPfenning_test_summitPlusMinus250bp.fa /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatum_nonCDS_enhancerShort_andLiver_mouseTest_summitPlusMinus250bp.fa /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatum_nonCDS_enhancerShort_andLiver_mouseTest_summitPlusMinus250bp.fa > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_andLiverLiuPfenning_test_summitPlusMinus250bp_andMacaqueBrainLiver_andRatBrainLiver.fa

# Get shared liver and brain enhancers for liver test set
# Mouse
zcat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_inBrain.narrowPeak.gz | grep -P 'chr1\t|chr2\t' | awk 'BEGIN{OFS="\t"} {print $1,$2+$10-250, $2+$10+250}' | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseGenome/mm10.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_inBrain_test_summitPlusMinus250bp.fa
# Macaque
zcat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_andBrain_mouseTest.bed.gz | awk 'BEGIN{OFS="\t"} {print $1,$2+$10-250, $2+$10+250}' | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueGenome/rheMac8.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_andBrain_mouseTest_summitPlusMinus250bp.fa
# Rat
zcat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/Liver_GoodReps/peak/idr_reproducibility/idr.optimal_peak_nonCDS_enhancerShort_inBrain_mouseTest.bed.gz | awk 'BEGIN{OFS="\t"} {print $1,$2+$10-250, $2+$10+250}' | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatGenome/rn6.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/Liver_GoodReps/peak/idr_reproducibility/idr.optimal_peak_nonCDS_enhancerShort_inBrain_mouseTest_summitPlusMinus250bp.fa
# Combine
cat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_inBrain_test_summitPlusMinus250bp.fa /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_andBrain_mouseTest_summitPlusMinus250bp.fa /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/Liver_GoodReps/peak/idr_reproducibility/idr.optimal_peak_nonCDS_enhancerShort_inBrain_mouseTest_summitPlusMinus250bp.fa > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_inBrain_test_summitPlusMinus250bp_andMacaqueLiverBrain_andRatLiverBrain.fa

# Get liver enhancers that are not brain enhancers for test set
# Mouse
zcat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_nonBrain.narrowPeak.gz | grep -P 'chr1\t|chr2\t' | awk 'BEGIN{OFS="\t"} {print $1,$2+$10-250, $2+$10+250}' | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseGenome/mm10.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_nonBrain_test_summitPlusMinus250bp.fa
# Macaque
zcat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_mouseTest_nonMacaqueBrain.bed.gz | awk 'BEGIN{OFS="\t"} {print $1,$2+$10-250, $2+$10+250}' | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueGenome/rheMac8.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_mouseTest_nonMacaqueBrain_summitPlusMinus250bp.fa
# Rat
zcat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/Liver_GoodReps/peak/idr_reproducibility/idr.optimal_peak_nonCDS_enhancerShort_nonRatBrain_mouseTest.bed.gz | awk 'BEGIN{OFS="\t"} {print $1,$2+$10-250, $2+$10+250}' | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatGenome/rn6.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/Liver_GoodReps/peak/idr_reproducibility/idr.optimal_peak_nonCDS_enhancerShort_nonRatBrain_mouseTest_summitPlusMinus250bp.fa
# Combine
cat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_nonBrain_test_summitPlusMinus250bp.fa /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_mouseTest_nonMacaqueBrain_summitPlusMinus250bp.fa /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/Liver_GoodReps/peak/idr_reproducibility/idr.optimal_peak_nonCDS_enhancerShort_nonRatBrain_mouseTest_summitPlusMinus250bp.fa > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_nonBrain_test_summitPlusMinus250bp_andMacaqueLiverNonBrain_andRatLiverNonBrain.fa

# Get brain enhancers that are not liver enhancers for test set
# Mouse
zcat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_nonLiver.narrowPeak.gz | grep -P 'chr1\t|chr2\t' | awk 'BEGIN{OFS="\t"} {print $1,$2+$10-250, $2+$10+250}' | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseGenome/mm10.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_nonLiver_test_summitPlusMinus250bp.fa
# Macaque
zcat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatum_nonCDS_enhancerShort_nonLiver_mouseTest.bed.gz | awk 'BEGIN{OFS="\t"} {print $1,$2+$10-250, $2+$10+250}' | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueGenome/rheMac8.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatum_nonCDS_enhancerShort_nonLiver_mouseTest_summitPlusMinus250bp.fa
# Rat
zcat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatum_nonCDS_enhancerShort_nonBrain_mouseTest.bed.gz | awk 'BEGIN{OFS="\t"} {print $1,$2+$10-250, $2+$10+250}' | fastaFromBed -fi /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatGenome/rn6.fa -bed stdin -fo /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatum_nonCDS_enhancerShort_nonBrain_mouseTest_summitPlusMinus250bp.fa
# Combine
cat /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_nonLiver_test_summitPlusMinus250bp.fa /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatum_nonCDS_enhancerShort_nonLiver_mouseTest_summitPlusMinus250bp.fa /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatum_nonCDS_enhancerShort_nonBrain_mouseTest_summitPlusMinus250bp.fa > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_nonLiver_test_summitPlusMinus250bp_andMacaqueBrainNonLiver_andRatBrainNonLiver.fa

# Performance of multi-species brain model
python /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/predictNewSequences.py --architectureFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/brainEnhancerVsOtherEuarchontaglireEnhMouseHumanMacaqueRatPeakLessThan1kb_data_train.KerasModels/hybrid_brainEnhancerShort_humanMouseMacaqueRat_euarchontaglireEnhLooseNeg_500bp_conv5MostFiltNoInterPoolVeryHighMomHighLRL2SmallBatchPretrainBal_architecture.json --weightsFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/brainEnhancerVsOtherEuarchontaglireEnhMouseHumanMacaqueRatPeakLessThan1kb_data_train.KerasModels/hybrid_brainEnhancerShort_humanMouseMacaqueRat_euarchontaglireEnhLooseNeg_500bp_conv5MostFiltNoInterPoolVeryHighMomHighLRL2SmallBatchPretrainBal.hdf5 --fastaFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_summitPlusMinus250bp_andHuman_andMacaque_andRat_test.fa --negFastaFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatumLoose_nonCDS_enhancerShort_mm10_summitExtendedMin50Max2XProtect5_nonMouseBrain_andMacaque_andRat_test_summitPlusMinus250bp_andHumanNeg_andMacaqueNeg_andRatNeg.fa --sequenceLength 500 --predictedProbaFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_summitPlusMinus250bp_andHuman_andMacaque_andRat_test_andNeg_conv5MostFiltNoInterPoolVeryHighMomHighLRL2SmallBatchPretrainBal_predictedProba.txt --RC --classification --path /home/ikaplow/RegulatoryElementEvolutionProject/src/deeplearning --plotRocPr --ROCFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_summitPlusMinus250bp_andHuman_andMacaque_andRat_test_andNeg_conv5MostFiltNoInterPoolVeryHighMomHighLRL2SmallBatchPretrainBal_ROC.png --PRFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_summitPlusMinus250bp_andHuman_andMacaque_andRat_test_andNeg_conv5MostFiltNoInterPoolVeryHighMomHighLRL2SmallBatchPretrainBal_PR.png
# Performance: loss: 0.397247, accuracy: 0.825828, sensitivity: 0.739159, specificity: 0.893031, auc: 0.900754, precision: 0.842718, NPV: 0.815340, auprc: 0.882919, auprg: 0.860601, F1: 0.787549, recallAt0.05FDR: 0.429713, recallAt0.1FDR: 0.621446
# Performance on clade-specific enhancers and non-enhancers
python /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/predictNewSequences.py --architectureFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/brainEnhancerVsOtherEuarchontaglireEnhMouseHumanMacaqueRatPeakLessThan1kb_data_train.KerasModels/hybrid_brainEnhancerShort_humanMouseMacaqueRat_euarchontaglireEnhLooseNeg_500bp_conv5MostFiltNoInterPoolVeryHighMomHighLRL2SmallBatchPretrainBal_architecture.json --weightsFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/brainEnhancerVsOtherEuarchontaglireEnhMouseHumanMacaqueRatPeakLessThan1kb_data_train.KerasModels/hybrid_brainEnhancerShort_humanMouseMacaqueRat_euarchontaglireEnhLooseNeg_500bp_conv5MostFiltNoInterPoolVeryHighMomHighLRL2SmallBatchPretrainBal.hdf5 --fastaFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_inRatBrainLoose_nonHumanBrain_nonMacaqueBrain_test_summitPlusMinus250bp_andEuarchontaSpecificLoose.fa --negFastaFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatum_nonCDS_enhancerShort_mm10_summitExtendedMin50Max2XProtect5_inMacaqueBrainLoose_nonMouseBrain_nonRatBrain_test_summitPlusMinus250bp_andEuarchontaSpecificNonEnhLoose.fa --sequenceLength 500 --RC --classification --path /home/ikaplow/RegulatoryElementEvolutionProject/src/deeplearning --plotRocPr --ROCFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_inRatBrainLoose_nonHumanBrain_nonMacaqueBrain_test_summitPlusMinus250bp_andEuarchontaSpecificLoose_andNeg_conv5MostFiltNoInterPoolVeryHighMomHighLRL2SmallBatchPretrainBal_ROC.png --PRFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_inRatBrainLoose_nonHumanBrain_nonMacaqueBrain_test_summitPlusMinus250bp_andEuarchontaSpecificLoose_andNeg_conv5MostFiltNoInterPoolVeryHighMomHighLRL2SmallBatchPretrainBal_PR.png
# Performance: loss: 0.431194, accuracy: 0.811813, sensitivity: 0.673077, specificity: 0.950549, auc: 0.908299, precision: 0.931559, NPV: 0.744086, auprc: 0.921803, auprg: 0.853699, F1: 0.781499, recallAt0.05FDR: 0.596154, recallAt0.1FDR: 0.739011
# Performance on species-specific enhancers and non-enhancers
python /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/predictNewSequences.py --architectureFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/brainEnhancerVsOtherEuarchontaglireEnhMouseHumanMacaqueRatPeakLessThan1kb_data_train.KerasModels/hybrid_brainEnhancerShort_humanMouseMacaqueRat_euarchontaglireEnhLooseNeg_500bp_conv5MostFiltNoInterPoolVeryHighMomHighLRL2SmallBatchPretrainBal_architecture.json --weightsFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/brainEnhancerVsOtherEuarchontaglireEnhMouseHumanMacaqueRatPeakLessThan1kb_data_train.KerasModels/hybrid_brainEnhancerShort_humanMouseMacaqueRat_euarchontaglireEnhLooseNeg_500bp_conv5MostFiltNoInterPoolVeryHighMomHighLRL2SmallBatchPretrainBal.hdf5 --fastaFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_withPeakNames_nonRatBrain_mouseTest_summitPlusMinus250bp_andHumanSpecificLoose_andMacaqueSpecificLoose_andRatSpecificLoose.fa --negFastaFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatum_nonCDS_enhancerShort_mm10_summitExtendedMin50Max2XProtect5_nonMouseBrain_mouseTest_summitPlusMinus250bp_andHumanSpecificNonEnhLoose_andMacaqueSpecificNonEnhLoose_andRatSpecificNonEnhLoose.fa --sequenceLength 500 --RC --classification --path /home/ikaplow/RegulatoryElementEvolutionProject/src/deeplearning --plotRocPr --ROCFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_nonRatBrain_mouseTest_andHumanSpecificLoose_andMacaqueSpecificLoose_andRatSpecificLoose_andNeg_conv5MostFiltNoInterPoolVeryHighMomHighLRL2SmallBatchPretrainBal_ROC.png --PRFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_nonRatBrain_mouseTest_andHumanSpecificLoose_andMacaqueSpecificLoose_andRatSpecificLoose_andNeg_conv5MostFiltNoInterPoolVeryHighMomHighLRL2SmallBatchPretrainBal_PR.png
# Performance: loss: 0.544001, accuracy: 0.738786, sensitivity: 0.678884, specificity: 0.798687, auc: 0.823627, precision: 0.771287, NPV: 0.713239, auprc: 0.815247, auprg: 0.665379, F1: 0.722141, recallAt0.05FDR: 0.010394, recallAt0.1FDR: 0.340810
# Performance on shared brain and liver enhancers and liver enhancers that are not brain enhancers
python /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/predictNewSequences.py --architectureFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/brainEnhancerVsOtherEuarchontaglireEnhMouseHumanMacaqueRatPeakLessThan1kb_data_train.KerasModels/hybrid_brainEnhancerShort_humanMouseMacaqueRat_euarchontaglireEnhLooseNeg_500bp_conv5MostFiltNoInterPoolVeryHighMomHighLRL2SmallBatchPretrainBal_architecture.json --weightsFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/brainEnhancerVsOtherEuarchontaglireEnhMouseHumanMacaqueRatPeakLessThan1kb_data_train.KerasModels/hybrid_brainEnhancerShort_humanMouseMacaqueRat_euarchontaglireEnhLooseNeg_500bp_conv5MostFiltNoInterPoolVeryHighMomHighLRL2SmallBatchPretrainBal.hdf5 --fastaFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_andLiverLiuPfenning_test_summitPlusMinus250bp_andMacaqueBrainLiver_andRatBrainLiver.fa --negFastaFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_nonBrain_test_summitPlusMinus250bp_andMacaqueLiverNonBrain_andRatLiverNonBrain.fa --sequenceLength 500 --RC --classification --path /home/ikaplow/RegulatoryElementEvolutionProject/src/deeplearning --plotRocPr --ROCFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_andLiverLiuPfenning_test_summitPlusMinus250bp_andMacaqueBrainLiver_andRatBrainLiver_andNeg_conv5MostFiltNoInterPoolVeryHighMomHighLRL2SmallBatchPretrainBal_ROC.png --PRFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_andLiverLiuPfenning_test_summitPlusMinus250bp_andMacaqueBrainLiver_andRatBrainLiver_andNeg_conv5MostFiltNoInterPoolVeryHighMomHighLRL2SmallBatchPretrainBal_PR.png
# Performance: loss: 0.269846, accuracy: 0.898346, sensitivity: 0.819748, specificity: 0.931007, auc: 0.943402, precision: 0.831576, NPV: 0.925537, auprc: 0.905133, auprg: 0.962898, F1: 0.825620, recallAt0.05FDR: 0.639223, recallAt0.1FDR: 0.745897
# Get brain test set predictions across Zoonomia mammals
python /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/gatherPeakPredictionsAcrossSpecies.py --predictionsFileNameListFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/predictionsMultiSpeciesModelGliresFileNames.txt --baseSpeciesLine 35 --outputFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_multiSpeciesModel_peakPredictionsGlires.txt
python /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/gatherPeakPredictionsAcrossSpecies.py --predictionsFileNameListFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/predictionsMultiSpeciesModelEuarchontaFileNames.txt --baseSpeciesLine 17 --outputFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_multiSpeciesModel_peakPredictionsEuarchonta.txt
python /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/filterPeakName.py --unfilteredPeakFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_multiSpeciesModel_peakPredictionsGlires.txt --unfilteredPeakNameCol 0 --peakListFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_orLiver_withPeakNames_brainOnly_test.bed.gz --peakNameCol 3 --outputFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_test_multiSpeciesModel_peakPredictionsGlires.txt
python /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/filterPeakName.py --unfilteredPeakFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_multiSpeciesModel_peakPredictionsEuarchonta.txt --unfilteredPeakNameCol 0 --peakListFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_orLiver_withPeakNames_brainOnly_test.bed.gz --peakNameCol 3 --outputFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_test_multiSpeciesModel_peakPredictionsEuarchonta.txt

# Performance of multi-species liver model
python /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/predictNewSequences.py --architectureFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/liverEnhancerVsOtherEuarchontaglireEnhMouseMacaqueRatPeakLessThan1kb_data_train.KerasModels/hybrid_liverPfenningLiuEnhancerShort_mouseMacaqueRat_euarchontaglireEnhLooseNeg_500bp_conv5MostFiltNoInterPoolVeryHighMomHighLRL2SmallBatchPretrainBal_architecture.json --weightsFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/liverEnhancerVsOtherEuarchontaglireEnhMouseMacaqueRatPeakLessThan1kb_data_train.KerasModels/hybrid_liverPfenningLiuEnhancerShort_mouseMacaqueRat_euarchontaglireEnhLooseNeg_500bp_conv5MostFiltNoInterPoolVeryHighMomHighLRL2SmallBatchPretrainBal.hdf5 --fastaFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.inLiuAll_nonCDS_enhancerShort_summitPlusMinus250bp_andMacaque_andRat_test.fa --negFastaFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_mm10Huge_summitExtendedMin50Max2Protect5_test_nonMouseLiver_andRat_summitPlusMinus250bp_andMacaqueNeg_andRatNeg.fa --sequenceLength 500 --predictedProbaFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.inLiuAll_nonCDS_enhancerShort_summitPlusMinus250bp_andMacaque_andRat_test_andNeg_conv5MostFiltNoInterPoolVeryHighMomHighLRL2SmallBatchPretrainBal_predictedProba.txt --RC --classification --path /home/ikaplow/RegulatoryElementEvolutionProject/src/deeplearning --plotRocPr --ROCFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.inLiuAll_nonCDS_enhancerShort_summitPlusMinus250bp_andMacaque_andRat_test_andNeg_conv5MostFiltNoInterPoolVeryHighMomHighLRL2SmallBatchPretrainBal_ROC.png --PRFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_summitPlusMinus250bp_andHuman_andMacaque_andRat_test_andNeg_conv5MostFiltNoInterPoolVeryHighMomHighLRL2SmallBatchPretrainBal_PR.png
# Performance: loss: 0.437605, accuracy: 0.801719, sensitivity: 0.822761, specificity: 0.776128, auc: 0.877036, precision: 0.817171, NPV: 0.782639, auprc: 0.858130, auprg: 0.802718, F1: 0.819957, recallAt0.05FDR: 0.279772, recallAt0.1FDR: 0.466172
# Performance on clade-specific enhancers and non-enhancers
python /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/predictNewSequences.py --architectureFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/liverEnhancerVsOtherEuarchontaglireEnhMouseMacaqueRatPeakLessThan1kb_data_train.KerasModels/hybrid_liverPfenningLiuEnhancerShort_mouseMacaqueRat_euarchontaglireEnhLooseNeg_500bp_conv5MostFiltNoInterPoolVeryHighMomHighLRL2SmallBatchPretrainBal_architecture.json --weightsFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/liverEnhancerVsOtherEuarchontaglireEnhMouseMacaqueRatPeakLessThan1kb_data_train.KerasModels/hybrid_liverPfenningLiuEnhancerShort_mouseMacaqueRat_euarchontaglireEnhLooseNeg_500bp_conv5MostFiltNoInterPoolVeryHighMomHighLRL2SmallBatchPretrainBal.hdf5 --fastaFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_inRatLiverLoose_nonMacaqueLiver_test_summitPlusMinus250bp_andEuarchontaSpecific.fa --negFastaFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/Liver/cromwell-executions/atac/1f5fd9f0-d389-4184-99cb-c1125fd7f064/call-reproducibility_idr/execution/optimal_peak_nonCDS_enhancerShort_mm10Huge_summitExtendedMin50Max2Protect5_nonMouseLiver_nonRatLiver_mouseTest_summitPlusMinus250bp_andEuarchontaSpecificNonEnhLoose.fa --sequenceLength 500 --RC --classification --path /home/ikaplow/RegulatoryElementEvolutionProject/src/deeplearning --plotRocPr --ROCFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_inRatLiverLoose_nonMacaqueLiver_test_summitPlusMinus250bp_andEuarchontaSpecific_andNeg_conv5MostFiltNoInterPoolVeryHighMomHighLRL2SmallBatchPretrainBal_ROC.png --PRFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_inRatLiverLoose_nonMacaqueLiver_test_summitPlusMinus250bp_andEuarchontaSpecific_andNeg_conv5MostFiltNoInterPoolVeryHighMomHighLRL2SmallBatchPretrainBal_PR.png
# Performance: loss: 0.449684, accuracy: 0.791228, sensitivity: 0.764912, specificity: 0.817544, auc: 0.871140, precision: 0.807407, NPV: 0.776667, auprc: 0.869711, auprg: 0.765842, F1: 0.785586, recallAt0.05FDR: 0.267368, recallAt0.1FDR: 0.515088
# Performance on species-specific enhancers and non-enhancers
python /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/predictNewSequences.py --architectureFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/liverEnhancerVsOtherEuarchontaglireEnhMouseMacaqueRatPeakLessThan1kb_data_train.KerasModels/hybrid_liverPfenningLiuEnhancerShort_mouseMacaqueRat_euarchontaglireEnhLooseNeg_500bp_conv5MostFiltNoInterPoolVeryHighMomHighLRL2SmallBatchPretrainBal_architecture.json --weightsFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/liverEnhancerVsOtherEuarchontaglireEnhMouseMacaqueRatPeakLessThan1kb_data_train.KerasModels/hybrid_liverPfenningLiuEnhancerShort_mouseMacaqueRat_euarchontaglireEnhLooseNeg_500bp_conv5MostFiltNoInterPoolVeryHighMomHighLRL2SmallBatchPretrainBal.hdf5 --fastaFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_nonRatLiver_test_summitPlusMinus250bp_andRatSpecificLoose.fa --negFastaFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/Liver_GoodReps/peak/idr_reproducibility/idr.optimal_peak_nonCDS_enhancerShort_mm10_summitExtendedMin50Max2XProtect5_nonMouseLiver_mouseTest_summitPlusMinus250bp_andRatSpecificNonEnhLoose.fa --sequenceLength 500 --RC --classification --path /home/ikaplow/RegulatoryElementEvolutionProject/src/deeplearning --plotRocPr --ROCFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_nonRatLiver_test_summitPlusMinus250bp_andRatSpecificLoose_andNeg_conv5MostFiltNoInterPoolVeryHighMomHighLRL2SmallBatchPretrainBal_ROC.png --PRFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_nonRatLiver_test_summitPlusMinus250bp_andRatSpecificLoose_andNeg_conv5MostFiltNoInterPoolVeryHighMomHighLRL2SmallBatchPretrainBal_PR.png
# Performance: loss: 0.592493, accuracy: 0.710574, sensitivity: 0.824390, specificity: 0.659091, auc: 0.814345, precision: 0.522411, NPV: 0.892441, auprc: 0.649190, auprg: 0.736241, F1: 0.639546, recallAt0.05FDR: 0.005854, recallAt0.1FDR: 0.006341
# Performance on shared liver and brain enhancers and brain enhancers that are not liver enhancers
python /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/predictNewSequences.py --architectureFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/liverEnhancerVsOtherEuarchontaglireEnhMouseMacaqueRatPeakLessThan1kb_data_train.KerasModels/hybrid_liverPfenningLiuEnhancerShort_mouseMacaqueRat_euarchontaglireEnhLooseNeg_500bp_conv5MostFiltNoInterPoolVeryHighMomHighLRL2SmallBatchPretrainBal_architecture.json --weightsFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/liverEnhancerVsOtherEuarchontaglireEnhMouseMacaqueRatPeakLessThan1kb_data_train.KerasModels/hybrid_liverPfenningLiuEnhancerShort_mouseMacaqueRat_euarchontaglireEnhLooseNeg_500bp_conv5MostFiltNoInterPoolVeryHighMomHighLRL2SmallBatchPretrainBal.hdf5 --fastaFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_inBrain_test_summitPlusMinus250bp_andMacaqueLiverBrain_andRatLiverBrain.fa --negFastaFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_nonLiver_test_summitPlusMinus250bp_andMacaqueBrainNonLiver_andRatBrainNonLiver.fa --sequenceLength 500 --RC --classification --path /home/ikaplow/RegulatoryElementEvolutionProject/src/deeplearning --plotRocPr --ROCFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_inBrain_test_summitPlusMinus250bp_andMacaqueLiverBrain_andRatLiverBrain_andNeg_conv5MostFiltNoInterPoolVeryHighMomHighLRL2SmallBatchPretrainBal_ROC.png --PRFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_inBrain_test_summitPlusMinus250bp_andMacaqueLiverBrain_andRatLiverBrain_andNeg_conv5MostFiltNoInterPoolVeryHighMomHighLRL2SmallBatchPretrainBal_PR.png
# Performance: loss: 0.421163, accuracy: 0.814902, sensitivity: 0.899951, specificity: 0.762078, auc: 0.916803, precision: 0.701430, NPV: 0.924608, auprc: 0.884210, auprg: 0.905747, F1: 0.788385, recallAt0.05FDR: 0.423679, recallAt0.1FDR: 0.666341
# Get liver test set predictions across Zoonomia mammals
python /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/gatherPeakPredictionsAcrossSpecies.py --predictionsFileNameListFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/predictionsEuarchontaFileNames.txt --baseSpeciesLine 17 --outputFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_peakPredictionsEuarchonta.txt
python /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/filterPeakName.py --unfilteredPeakFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_peakPredictionsGlires.txt --unfilteredPeakNameCol 0 --peakListFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_test.bed.gz --peakNameCol 3 --outputFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_test_multiSpeciesModel_peakPredictionsGlires.txt
python /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/filterPeakName.py --unfilteredPeakFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_peakPredictionsEuarchonta.txt --unfilteredPeakNameCol 0 --peakListFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_test.bed.gz --peakNameCol 3 --outputFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_test_multiSpeciesModel_peakPredictionsEuarchonta.txt
# Performance on non-restrictive laurasatheria-specific enhancers and non-enhancers
python /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/predictNewSequences.py --architectureFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/liverEnhancerVsOtherEuarchontaglireEnhMouseMacaqueRatPeakLessThan1kb_data_train.KerasModels/hybrid_liverPfenningLiuEnhancerShort_mouseMacaqueRat_euarchontaglireEnhLooseNeg_500bp_conv5MostFiltNoInterPoolVeryHighMomHighLRL2SmallBatchPretrainBal_architecture.json --weightsFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/liverEnhancerVsOtherEuarchontaglireEnhMouseMacaqueRatPeakLessThan1kb_data_train.KerasModels/hybrid_liverPfenningLiuEnhancerShort_mouseMacaqueRat_euarchontaglireEnhLooseNeg_500bp_conv5MostFiltNoInterPoolVeryHighMomHighLRL2SmallBatchPretrainBal.hdf5 --narrowPeakFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/CowDNase/Liver/atac/888ae501-7469-4afa-8890-e36f14f6c83b/peak/idr_reproducibility/idr.optimal_peak_nonCDS_enhancerShort_inPigLiverLoose_nonMouseLiver_nonRatLiver_nonMacaqueLiver_test.bed.gz --negNarrowPeakFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.inLiuAllNonLoose_nonCDS_enhancerShort_bosTau2015Fixed_summitExtendedMin50Max2XProtect5_RefSeqNames_nonCowLiver_inRatLiverLoose_inMacaqueLiverLoose_nonPigLiver_test.bed.gz --sequenceLength 500 --genomeFileName /home/ikaplow/RegulatoryElementEvolutionProject/GenomeDataPipelines/bosTau2015/GCF_000003205.7_Btau_5.0.1_genomic_withChrM.fa --RC --classification --path /home/ikaplow/RegulatoryElementEvolutionProject/src/deeplearning
# Performance: loss: 0.609153, accuracy: 0.723926, sensitivity: 0.831169, specificity: 0.627907, auc: 0.778919, precision: 0.666667, NPV: 0.805970, auprc: 0.738950, auprg: 0.537756, F1: 0.739884, recallAt0.05FDR: 0.032468, recallAt0.1FDR: 0.123377