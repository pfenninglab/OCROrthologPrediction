# Compare mouse liver clusters to mouse liver scATAC-seq
sed '1d' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/scATAC/open_sites_0.01.txt | awk 'BEGIN{OFS="\t"} $5==3' | awk 'BEGIN{OFS="\t"} $6==1' | cut -f1 | sed 's/_/\t/g' | sort -u -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/scATAC/open_sites_0.01_hepatocytes.bed
sed '1d' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/scATAC/open_sites_0.01.txt | awk 'BEGIN{OFS="\t"} $5==22' | awk 'BEGIN{OFS="\t"} $6==3' | cut -f1 | sed 's/_/\t/g' | sort -u -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/scATAC/open_sites_0.01_endothelialCells.bed
python /home/ikaplow/RegulatoryElementEvolutionProject/src/IMKTFBindingCode/makeLolaScript.py --queryRegionListFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/scATAC/liverClusterFileNames.txt --universeDataFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort.bed --dbLocation /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/ --scriptFileName /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/runLolaMouseLiverEnhancersScript.sh --bedMade --queriesAreBeds --path /home/ikaplow/RegulatoryElementEvolutionProject/src/IMKTFBindingCode --redefineUserSets
sh /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/runLolaMouseLiverEnhancersScript.sh
python /home/ikaplow/RegulatoryElementEvolutionProject/src/IMKTFBindingCode/processLolaResults.py --lolaResultsFileNameListFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_scLolaResultsFileNames.txt --lolaHeadersFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/LolaHeaders.txt --outputFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_scLolaResults_summary.txt --rowHeaderIndex 1 --rowHeaderElementIndex 1

# Compare mouse brain clusters to mouse brain scATAC-seq
python /home/ikaplow/RegulatoryElementEvolutionProject/src/IMKTFBindingCode/makeLolaScript.py --queryRegionListFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/M1ScAtacSeqNEMO/BICCN_mouse_NEMO_snATAC-Seq_enhancerShortFileNames.txt --universeDataFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort.bed --dbLocation /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/ --scriptFileName /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/runLolaMouseBrainEnhancersScript.sh --bedMade --queriesAreBeds --path /home/ikaplow/RegulatoryElementEvolutionProject/src/IMKTFBindingCode --redefineUserSets
sh /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/runLolaMouseBrainEnhancersScript.sh
python /home/ikaplow/RegulatoryElementEvolutionProject/src/IMKTFBindingCode/processLolaResults.py --lolaResultsFileNameListFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_scLolaResultsFileNames.txt --lolaHeadersFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/LolaHeaders.txt --outputFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_scLolaResults_summary.txt --rowHeaderElementIndex 4

# Compare human brain clusters to human brain scATAC-seq
python /home/ikaplow/RegulatoryElementEvolutionProject/src/IMKTFBindingCode/makeLolaScript.py --queryRegionListFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/M1SnareSeq/BICCN_huMOp_SNARE-Seq2_enhancerShortFileNames.txt --universeDataFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatum_nonCDS_enhancerShort.bed --dbLocation /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/ --scriptFileName /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/runLolaHumanBrainEnhancersScript.sh --bedMade --queriesAreBeds --path /home/ikaplow/RegulatoryElementEvolutionProject/src/IMKTFBindingCode --redefineUserSets
sh /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/runLolaHumanBrainEnhancersScript.sh
python /home/ikaplow/RegulatoryElementEvolutionProject/src/IMKTFBindingCode/processLolaResults.py --lolaResultsFileNameListFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatum_nonCDS_enhancerShort_scLolaResultsFileNames.txt --lolaHeadersFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/LolaHeaders.txt --outputFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatum_nonCDS_enhancerShort_scLolaResults_summary.txt --rowHeaderElementIndex 3

# Compare mouse liver clusters to other mouse liver enhancer datasets
# Regeneration (mm10)
sed '1d' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Wang2019_SupplementaryTable1.txt | awk 'BEGIN{OFS="\t"} $8 < 0.05' | awk 'BEGIN{OFS="\t"} $6 > 1' | cut -f1-3 | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Wang2019_CtlvsW1Up.bed
sed '1d' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Wang2019_SupplementaryTable1.txt | awk 'BEGIN{OFS="\t"} $8 < 0.05' | awk 'BEGIN{OFS="\t"} $6 < -1' | cut -f1-3 | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Wang2019_CtlvsW1Down.bed
sed '1d' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Wang2019_SupplementaryTable1.txt | awk 'BEGIN{OFS="\t"} $11 < 0.05' | awk 'BEGIN{OFS="\t"} $9 > 1' | cut -f1-3 | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Wang2019_CtlvsW4Up.bed
sed '1d' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Wang2019_SupplementaryTable1.txt | awk 'BEGIN{OFS="\t"} $11 < 0.05' | awk 'BEGIN{OFS="\t"} $9 < -1' | cut -f1-3 | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Wang2019_CtlvsW4Down.bed
sed '1d' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Wang2019_SupplementaryTable1.txt | awk 'BEGIN{OFS="\t"} $14 < 0.05' | awk 'BEGIN{OFS="\t"} $12 > 1' | cut -f1-3 | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Wang2019_W1vsW4Up.bed
sed '1d' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Wang2019_SupplementaryTable1.txt | awk 'BEGIN{OFS="\t"} $14 < 0.05' | awk 'BEGIN{OFS="\t"} $12 < -1' | cut -f1-3 | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Wang2019_W1vsW4Down.bed
intersectBed -wa -u -a /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_3Col.bed -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/collection/regions/cluster100.bed | intersectBed -wa -u -a stdin -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Wang2019_CtlvsW4Up.bed > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Wang2019_CtlvsW4Up_cluster100_forGREAT.bed
intersectBed -wa -u -a /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_3Col.bed -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/collection/regions/cluster29.bed | intersectBed -wa -u -a stdin -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Wang2019_CtlvsW4Up.bed > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Wang2019_CtlvsW4Up_cluster29_forGREAT.bed
intersectBed -wa -u -a /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_3Col.bed -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/collection/regions/cluster36.bed | intersectBed -wa -u -a stdin -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Wang2019_CtlvsW4Up.bed > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Wang2019_CtlvsW4Up_cluster36_forGREAT.bed
intersectBed -wa -u -a /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Wang2019_CtlvsW4Up.bed -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/collection/regions/cluster100.bed > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Wang2019_CtlvsW4Up_inCluster100.bed
intersectBed -wa -u -a /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Wang2019_CtlvsW4Up.bed -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/collection/regions/cluster29.bed > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Wang2019_CtlvsW4Up_inCluster29.bed
intersectBed -wa -u -a /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Wang2019_CtlvsW4Up.bed -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/collection/regions/cluster36.bed > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Wang2019_CtlvsW4Up_inCluster36.bed
intersectBed -wa -u -a /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort.bed -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Wang2019_CtlvsW4Up.bed > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Wang2019_CtlvsW4Up_mouseLiver.bed
cut -f1-3 /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Wang2019_CtlvsW4Up_mouseLiver.bed > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Wang2019_CtlvsW4Up_mouseLiver_3Col.bed
python /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/getNumberUsableOrthologs.py --predictionsFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_peakPredictions.txt --outputFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_numUsableOrthologs.txt
python /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/filterPeakName.py --unfilteredPeakFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_numUsableOrthologs.txt --unfilteredPeakNameCol 0 --peakListFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Wang2019_CtlvsW4Up_mouseLiver.bed --peakNameCol 3 --outputFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_numUsableOrthologs_Wang2019_CtlvsW4Up.txt
awk 'BEGIN{OFS="\t"} {print $1, $2+$10, $2+$10+1, $4}' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Wang2019_CtlvsW4Up_mouseLiver.bed | /home/ikaplow/RegulatoryElementEvolutionProject/src/bigWigAverageOverBed -bedOut=/projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Wang2019_CtlvsW4Up_mouseLiver_summitPlusMinus250bp_conservationPhastConsPlacental.bed -sampleAroundCenter=500 -minMax /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseGenome/mm10.60way.phastCons60wayPlacental.bw stdin /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Wang2019_CtlvsW4Up_mouseLiver_summitPlusMinus250bp_conservationPhastConsPlacental.tab
awk 'BEGIN{OFS="\t"} {print $1, $2+$10, $2+$10+1, $4}' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Wang2019_CtlvsW4Up_mouseLiver.bed | /home/ikaplow/RegulatoryElementEvolutionProject/src/bigWigAverageOverBed -bedOut=/projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Wang2019_CtlvsW4Up_mouseLiver_summitPlusMinus250bp_conservationPhyloPPlacental.bed -sampleAroundCenter=500 -minMax /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseGenome/mm10.60way.phyloP60wayPlacental.bw stdin /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Wang2019_CtlvsW4Up_mouseLiver_summitPlusMinus250bp_conservationPhyloPPlacental.tab
# Response to liver carcinogen (mm9)
cut -f1-3,6 /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Lodato2018_toxsci-18-0064-File004.txt | grep open | cut -f1-3 | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Lodato2018_toxsci-18-0064-File004_M3hrOpen.bed
cut -f1-3,6 /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Lodato2018_toxsci-18-0064-File004.txt | grep close | cut -f1-3 | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Lodato2018_toxsci-18-0064-File004_M3hrClosed.bed # Only 72 enhancers
cut -f1-3,7 /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Lodato2018_toxsci-18-0064-File004.txt | grep open | cut -f1-3 | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Lodato2018_toxsci-18-0064-File004_M27hrOpen.bed
cut -f1-3,7 /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Lodato2018_toxsci-18-0064-File004.txt | grep close | cut -f1-3 | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Lodato2018_toxsci-18-0064-File004_M27hrClosed.bed
cut -f1-3,8 /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Lodato2018_toxsci-18-0064-File004.txt | grep open | cut -f1-3 | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Lodato2018_toxsci-18-0064-File004_F3hrOpen.bed
cut -f1-3,8 /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Lodato2018_toxsci-18-0064-File004.txt | grep close | cut -f1-3 | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Lodato2018_toxsci-18-0064-File004_F3hrClosed.bed
cut -f1-3,9 /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Lodato2018_toxsci-18-0064-File004.txt | grep open | cut -f1-3 | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Lodato2018_toxsci-18-0064-File004_F27hrOpen.bed
cut -f1-3,9 /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Lodato2018_toxsci-18-0064-File004.txt | grep close | cut -f1-3 | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Lodato2018_toxsci-18-0064-File004_F27hrClosed.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/liftOver /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Lodato2018_toxsci-18-0064-File004_M3hrOpen.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/LiftoverChains/mm9ToMm10.over.chain.gz /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Lodato2018_toxsci-18-0064-File004_M3hrOpen_mm10.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Lodato2018_toxsci-18-0064-File004_M3hrOpen_unmapped.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/liftOver /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Lodato2018_toxsci-18-0064-File004_M3hrClosed.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/LiftoverChains/mm9ToMm10.over.chain.gz /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Lodato2018_toxsci-18-0064-File004_M3hrClosed_mm10.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Lodato2018_toxsci-18-0064-File004_M3hrClosed_unmapped.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/liftOver /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Lodato2018_toxsci-18-0064-File004_M27hrOpen.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/LiftoverChains/mm9ToMm10.over.chain.gz /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Lodato2018_toxsci-18-0064-File004_M27hrOpen_mm10.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Lodato2018_toxsci-18-0064-File004_M27hrOpen_unmapped.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/liftOver /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Lodato2018_toxsci-18-0064-File004_M27hrClosed.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/LiftoverChains/mm9ToMm10.over.chain.gz /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Lodato2018_toxsci-18-0064-File004_M27hrClosed_mm10.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Lodato2018_toxsci-18-0064-File004_M27hrClosed_unmapped.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/liftOver /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Lodato2018_toxsci-18-0064-File004_F3hrOpen.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/LiftoverChains/mm9ToMm10.over.chain.gz /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Lodato2018_toxsci-18-0064-File004_F3hrOpen_mm10.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Lodato2018_toxsci-18-0064-File004_F3hrOpen_unmapped.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/liftOver /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Lodato2018_toxsci-18-0064-File004_F3hrClosed.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/LiftoverChains/mm9ToMm10.over.chain.gz /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Lodato2018_toxsci-18-0064-File004_F3hrClosed_mm10.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Lodato2018_toxsci-18-0064-File004_F3hrClosed_unmapped.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/liftOver /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Lodato2018_toxsci-18-0064-File004_F27hrOpen.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/LiftoverChains/mm9ToMm10.over.chain.gz /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Lodato2018_toxsci-18-0064-File004_F27hrOpen_mm10.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Lodato2018_toxsci-18-0064-File004_F27hrOpen_unmapped.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/liftOver /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Lodato2018_toxsci-18-0064-File004_F27hrClosed.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/LiftoverChains/mm9ToMm10.over.chain.gz /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Lodato2018_toxsci-18-0064-File004_F27hrClosed_mm10.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Lodato2018_toxsci-18-0064-File004_F27hrClosed_unmapped.bed
# Sex-specificity (mm9)
sed '1d' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Ling2010_GHresp_sex_spDHS.bed | cut -f1-3 | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Ling2010_GHresp_sex_spDHS_modified.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/liftOver /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Ling2010_GHresp_sex_spDHS_modified.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/LiftoverChains/mm9ToMm10.over.chain.gz /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Ling2010_GHresp_sex_spDHS_modified_mm10.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Ling2010_GHresp_sex_spDHS_modified_unmapped.bed
# Fasting (mm9)
sed '1d' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Goldstein2016_Supplemental_Table_S5.txt | awk 'BEGIN{OFS="\t"} $9 > 1' | cut -f2-4 | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Goldstein2016_FastingUp.bed
sed '1d' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Goldstein2016_Supplemental_Table_S5.txt | awk 'BEGIN{OFS="\t"} $9 < -1' | cut -f2-4 | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Goldstein2016_FastingDown.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/liftOver /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Goldstein2016_FastingUp.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/LiftoverChains/mm9ToMm10.over.chain.gz /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Goldstein2016_FastingUp_mm10.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Goldstein2016_FastingUp_unmapped.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/liftOver /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Goldstein2016_FastingDown.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/LiftoverChains/mm9ToMm10.over.chain.gz /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Goldstein2016_FastingDown_mm10.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/Goldstein2016_FastingDown_unmapped.bed
# Run LOLA
python /home/ikaplow/RegulatoryElementEvolutionProject/src/IMKTFBindingCode/makeLolaScript.py --queryRegionListFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/LiverEnhancers/MouseLiverEnhancers/mouseLiverEnhancerSetFileNames.txt --universeDataFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort.bed --dbLocation /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/ --scriptFileName /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/runLolaMouseLiverEnhancerSetsScript.sh --bedMade --queriesAreBeds --path /home/ikaplow/RegulatoryElementEvolutionProject/src/IMKTFBindingCode --redefineUserSets
sh /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/runLolaMouseLiverEnhancerSetsScript.sh
python /home/ikaplow/RegulatoryElementEvolutionProject/src/IMKTFBindingCode/processLolaResults.py --lolaResultsFileNameListFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_enhSetLolaResultsFileNames.txt --lolaHeadersFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/LolaHeaders.txt --outputFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_enhSetResults_summary.txt --rowHeaderIndex 0 --rowHeaderElementIndex 1
# Evaluate LOLA for only liver regeneration enhancers (top enrichments are consistent when more enhancer sets are included in evaluation)
python /home/ikaplow/RegulatoryElementEvolutionProject/src/IMKTFBindingCode/processLolaResults.py --lolaResultsFileNameListFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_liverRegenerationLolaResultsFileNames.txt --lolaHeadersFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/LolaHeaders.txt --outputFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/LiverPfenning_ATAC_out/atac/68eb27d1-23c7-4d42-80f9-b3dd46f5e18c/call-reproducibility_idr/execution/idr.optimal_peak.narrowPeak_inLiuAll_nonCDS_enhancerShort_liverRegenerationResults_summary.txt --rowHeaderIndex 0 --rowHeaderElementIndex 1

# Compare mouse brain clusters to other mouse brain enhancer datasets
# Neuronal firing (mm9)
sed '1d' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Beagan2020_TableS11.txt | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Beagan2020_TableS11.bed
sed '1d' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Beagan2020_TableS12.txt | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Beagan2020_TableS12.bed
sed '1d' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Beagan2020_TableS13.txt | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Beagan2020_TableS13.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/liftOver /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Beagan2020_TableS11.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/LiftoverChains/mm9ToMm10.over.chain.gz /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Beagan2020_TableS11_mm10.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Beagan2020_TableS11_unmapped.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/liftOver /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Beagan2020_TableS12.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/LiftoverChains/mm9ToMm10.over.chain.gz /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Beagan2020_TableS12_mm10.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Beagan2020_TableS12_unmapped.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/liftOver /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Beagan2020_TableS13.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/LiftoverChains/mm9ToMm10.over.chain.gz /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Beagan2020_TableS13_mm10.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Beagan2020_TableS13_unmapped.bed
intersectBed -wa -u -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Beagan2020_TableS11_mm10.bed -a /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/collection/regions/cluster27.bed > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Beagan2020_TableS11_mm10_cluster27.bed
intersectBed -wa -u -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Beagan2020_TableS11_mm10.bed -a /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/collection/regions/cluster43.bed > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Beagan2020_TableS11_mm10_cluster43.bed
intersectBed -wa -u -a /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_3Col.bed -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Beagan2020_TableS11_mm10_cluster27.bed > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Beagan2020_TableS11_mm10_cluster27_forGREAT.bed
intersectBed -wa -u -a /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_3Col.bed -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Beagan2020_TableS11_mm10_cluster43.bed > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Beagan2020_TableS11_mm10_cluster43_forGREAT.bed
python /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/getNumberUsableOrthologs.py --predictionsFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_multiSpeciesModel_peakPredictions.txt --outputFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_numUsableOrthologs.txt
intersectBed -wa -u -a /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_orLiver_withPeakNames_brainOnly.bed.gz -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Beagan2020_TableS11_mm10.bed > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Beagan2020_TableS11_mm10_mouseBrain.bed
cut -f1-3 /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Beagan2020_TableS11_mm10_mouseBrain.bed > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Beagan2020_TableS11_mm10_mouseBrain_3Col.bed
intersectBed -wa -u -a /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Beagan2020_TableS11_mm10.bed -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/collection/regions/cluster27.bed > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Beagan2020_TableS11_mm10_inCluster27.bed
intersectBed -wa -u -a /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Beagan2020_TableS11_mm10.bed -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/collection/regions/cluster43.bed > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Beagan2020_TableS11_mm10_inCluster43.bed
closestBed -d -t all -a /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Beagan2020_TableS11_mm10_inCluster27.bed -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseGenome/gencode.vM15.annotation.protTranscript.geneNames_TSSWithStrand_sorted.bed > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Beagan2020_TableS11_mm10_inCluster27_closestGene.bed
closestBed -d -t all -a /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Beagan2020_TableS11_mm10_inCluster43.bed -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseGenome/gencode.vM15.annotation.protTranscript.geneNames_TSSWithStrand_sorted.bed > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Beagan2020_TableS11_mm10_inCluster43_closestGene.bed
python /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/filterPeakName.py --unfilteredPeakFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_numUsableOrthologs.txt --unfilteredPeakNameCol 0 --peakListFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Beagan2020_TableS11_mm10_mouseBrain.bed --peakNameCol 3 --outputFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_numUsableOrthologs_Beagan2020_TableS11.txt
awk 'BEGIN{OFS="\t"} {print $1, $2+$10, $2+$10+1, $4}' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Beagan2020_TableS11_mm10_mouseBrain.bed | /home/ikaplow/RegulatoryElementEvolutionProject/src/bigWigAverageOverBed -bedOut=/projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Beagan2020_TableS11_mm10_mouseBrain_summitPlusMinus250bp_conservationPhastConsPlacental.bed -sampleAroundCenter=500 -minMax /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseGenome/mm10.60way.phastCons60wayPlacental.bw stdin /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Beagan2020_TableS11_mm10_mouseBrain_summitPlusMinus250bp_conservationPhastConsPlacental.tab
awk 'BEGIN{OFS="\t"} {print $1, $2+$10, $2+$10+1, $4}' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Beagan2020_TableS11_mm10_mouseBrain.bed | /home/ikaplow/RegulatoryElementEvolutionProject/src/bigWigAverageOverBed -bedOut=/projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Beagan2020_TableS11_mm10_mouseBrain_summitPlusMinus250bp_conservationPhyloPPlacental.bed -sampleAroundCenter=500 -minMax /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseGenome/mm10.60way.phyloP60wayPlacental.bw stdin /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Beagan2020_TableS11_mm10_mouseBrain_summitPlusMinus250bp_conservationPhyloPPlacental.tab
# AD (mm9)
sed '1d' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Gjoneska2015_41586_2015_BFnature14252_MOESM150_ESM.txt | grep H3K27ac | awk 'BEGIN{OFS="\t"} $11>1' | awk 'BEGIN{OFS="\t"} $15 < 0.05' | cut -f1-3 | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Gjoneska2015_41586_2015_BFnature14252_MOESM150_ESM_2WkUp.bed
sed '1d' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Gjoneska2015_41586_2015_BFnature14252_MOESM150_ESM.txt | grep H3K27ac | awk 'BEGIN{OFS="\t"} $11<-1' | awk 'BEGIN{OFS="\t"} $15 < 0.05' | cut -f1-3 | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Gjoneska2015_41586_2015_BFnature14252_MOESM150_ESM_2WkDown.bed
sed '1d' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Gjoneska2015_41586_2015_BFnature14252_MOESM150_ESM.txt | grep H3K27ac | awk 'BEGIN{OFS="\t"} $12>1' | awk 'BEGIN{OFS="\t"} $16 < 0.05' | cut -f1-3 | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Gjoneska2015_41586_2015_BFnature14252_MOESM150_ESM_6WkUp.bed
sed '1d' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Gjoneska2015_41586_2015_BFnature14252_MOESM150_ESM.txt | grep H3K27ac | awk 'BEGIN{OFS="\t"} $12<-1' | awk 'BEGIN{OFS="\t"} $16 < 0.05' | cut -f1-3 | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Gjoneska2015_41586_2015_BFnature14252_MOESM150_ESM_6WkDown.bed
sed '1d' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Gjoneska2015_41586_2015_BFnature14252_MOESM150_ESM.txt | grep H3K27ac | awk 'BEGIN{OFS="\t"} $13>1' | awk 'BEGIN{OFS="\t"} $17 < 0.05' | cut -f1-3 | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Gjoneska2015_41586_2015_BFnature14252_MOESM150_ESM_Ckp25Up.bed
sed '1d' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Gjoneska2015_41586_2015_BFnature14252_MOESM150_ESM.txt | grep H3K27ac | awk 'BEGIN{OFS="\t"} $13<-1' | awk 'BEGIN{OFS="\t"} $17 < 0.05' | cut -f1-3 | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Gjoneska2015_41586_2015_BFnature14252_MOESM150_ESM_Ckp25Down.bed
sed '1d' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Gjoneska2015_41586_2015_BFnature14252_MOESM150_ESM.txt | grep H3K27ac | awk 'BEGIN{OFS="\t"} $14>1' | awk 'BEGIN{OFS="\t"} $18 < 0.05' | cut -f1-3 | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Gjoneska2015_41586_2015_BFnature14252_MOESM150_ESM_6v2Up.bed
sed '1d' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Gjoneska2015_41586_2015_BFnature14252_MOESM150_ESM.txt | grep H3K27ac | awk 'BEGIN{OFS="\t"} $14<-1' | awk 'BEGIN{OFS="\t"} $18 < 0.05' | cut -f1-3 | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Gjoneska2015_41586_2015_BFnature14252_MOESM150_ESM_6v2Down.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/liftOver /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Gjoneska2015_41586_2015_BFnature14252_MOESM150_ESM_2WkUp.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/LiftoverChains/mm9ToMm10.over.chain.gz /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Gjoneska2015_41586_2015_BFnature14252_MOESM150_ESM_2WkUp_mm10.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Gjoneska2015_41586_2015_BFnature14252_MOESM150_ESM_2WkUp_unmapped.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/liftOver /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Gjoneska2015_41586_2015_BFnature14252_MOESM150_ESM_2WkDown.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/LiftoverChains/mm9ToMm10.over.chain.gz /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Gjoneska2015_41586_2015_BFnature14252_MOESM150_ESM_2WkDown_mm10.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Gjoneska2015_41586_2015_BFnature14252_MOESM150_ESM_2WkDown_unmapped.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/liftOver /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Gjoneska2015_41586_2015_BFnature14252_MOESM150_ESM_6WkUp.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/LiftoverChains/mm9ToMm10.over.chain.gz /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Gjoneska2015_41586_2015_BFnature14252_MOESM150_ESM_6WkUp_mm10.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Gjoneska2015_41586_2015_BFnature14252_MOESM150_ESM_6WkUp_unmapped.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/liftOver /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Gjoneska2015_41586_2015_BFnature14252_MOESM150_ESM_6WkDown.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/LiftoverChains/mm9ToMm10.over.chain.gz /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Gjoneska2015_41586_2015_BFnature14252_MOESM150_ESM_6WkDown_mm10.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Gjoneska2015_41586_2015_BFnature14252_MOESM150_ESM_6WkDown_unmapped.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/liftOver /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Gjoneska2015_41586_2015_BFnature14252_MOESM150_ESM_Ckp25Up.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/LiftoverChains/mm9ToMm10.over.chain.gz /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Gjoneska2015_41586_2015_BFnature14252_MOESM150_ESM_Ckp25Up_mm10.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Gjoneska2015_41586_2015_BFnature14252_MOESM150_ESM_Ckp25Up_unmapped.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/liftOver /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Gjoneska2015_41586_2015_BFnature14252_MOESM150_ESM_Ckp25Down.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/LiftoverChains/mm9ToMm10.over.chain.gz /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Gjoneska2015_41586_2015_BFnature14252_MOESM150_ESM_Ckp25Down_mm10.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Gjoneska2015_41586_2015_BFnature14252_MOESM150_ESM_Ckp25Down_unmapped.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/liftOver /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Gjoneska2015_41586_2015_BFnature14252_MOESM150_ESM_6v2Up.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/LiftoverChains/mm9ToMm10.over.chain.gz /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Gjoneska2015_41586_2015_BFnature14252_MOESM150_ESM_6v2Up_mm10.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Gjoneska2015_41586_2015_BFnature14252_MOESM150_ESM_6v2Up_unmapped.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/liftOver /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Gjoneska2015_41586_2015_BFnature14252_MOESM150_ESM_6v2Down.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/LiftoverChains/mm9ToMm10.over.chain.gz /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Gjoneska2015_41586_2015_BFnature14252_MOESM150_ESM_6v2Down_mm10.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/Gjoneska2015_41586_2015_BFnature14252_MOESM150_ESM_6v2Down_unmapped.bed
# Run LOLA
python /home/ikaplow/RegulatoryElementEvolutionProject/src/IMKTFBindingCode/makeLolaScript.py --queryRegionListFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MouseBrainEnhancers/mouseBrainEnhancerFileNames.txt --universeDataFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort.bed --dbLocation /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/ --scriptFileName /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/runLolaMouseBrainEnhancerSetsScript.sh --bedMade --queriesAreBeds --path /home/ikaplow/RegulatoryElementEvolutionProject/src/IMKTFBindingCode --redefineUserSets
sh /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/runLolaMouseBrainEnhancerSetsScript.sh
python /home/ikaplow/RegulatoryElementEvolutionProject/src/IMKTFBindingCode/processLolaResults.py --lolaResultsFileNameListFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_enhSetLolaResultsFileNames.txt --lolaHeadersFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/LolaHeaders.txt --outputFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_enhSetLolaResults_summary.txt --rowHeaderIndex 0 --rowHeaderElementIndex 1
# Evaluate LOLA for only neuron firing (top enrichments are consistent when more enhancer sets are included in evaluation)
python /home/ikaplow/RegulatoryElementEvolutionProject/src/IMKTFBindingCode/processLolaResults.py --lolaResultsFileNameListFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_neuronFiringLolaResultsFileNames.txt --lolaHeadersFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/LolaHeaders.txt --outputFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MouseDNase/Cortex_AgeB_ATAC_out/peak/macs2/idr/optimal_set/Cortex_AgeB_ATAC_out_ppr.IDR0.1.filt.inAgeBAndStriatum_enhancerShort_neuronFiringLolaResults_summary.txt --rowHeaderIndex 0 --rowHeaderElementIndex 1

# Compare rat brain clusters to other rat brain enhancer datasets
# Cocaine (rn6)
sed '1d' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/RatBrainEnhancers/Scherma2020_pnas.1920866117.sd01.txt | awk 'BEGIN{OFS="\t"} $13 > 1' | cut -f2-4 | sed 's/,//g' | sed 's/^/chr/g' | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/RatBrainEnhancers/Scherma2020_pnas.1920866117.sd01_WMinusCocVsCocUp.bed
sed '1d' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/RatBrainEnhancers/Scherma2020_pnas.1920866117.sd01.txt | awk 'BEGIN{OFS="\t"} $13 < -1' | cut -f2-4 | sed 's/,//g' | sed 's/^/chr/g' | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/RatBrainEnhancers/Scherma2020_pnas.1920866117.sd01_WMinusCocVsCocDown.bed
sed '1d' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/RatBrainEnhancers/Scherma2020_pnas.1920866117.sd01.txt | awk 'BEGIN{OFS="\t"} $14 > 1' | cut -f2-4 | sed 's/,//g' | sed 's/^/chr/g' | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/RatBrainEnhancers/Scherma2020_pnas.1920866117.sd01_WINVsControlUp.bed
sed '1d' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/RatBrainEnhancers/Scherma2020_pnas.1920866117.sd01.txt | awk 'BEGIN{OFS="\t"} $14 < -1' | cut -f2-4 | sed 's/,//g' | sed 's/^/chr/g' | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/RatBrainEnhancers/Scherma2020_pnas.1920866117.sd01_WINVsControlDown.bed
# Run LOLA
python /home/ikaplow/RegulatoryElementEvolutionProject/src/IMKTFBindingCode/makeLolaScript.py --queryRegionListFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/RatBrainEnhancers/ratBrainEnhancerFileNames.txt --universeDataFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatum_nonCDS_enhancerShort.bed --dbLocation /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility --scriptFileName /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/runLolaRatBrainEnhancerSetsScript.sh --bedMade --queriesAreBeds --path /home/ikaplow/RegulatoryElementEvolutionProject/src/IMKTFBindingCode --redefineUserSets
sh /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/runLolaRatBrainEnhancerSetsScript.sh
python /home/ikaplow/RegulatoryElementEvolutionProject/src/IMKTFBindingCode/processLolaResults.py --lolaResultsFileNameListFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatum_nonCDS_enhancerShort_enhSetLolaResultsFileNames.txt --lolaHeadersFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/LolaHeaders.txt --outputFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/RatAtac/M1_AllReps/peak/idr_reproducibility/idr.optimal_peak.inStriatum_nonCDS_enhancerShort_enhSetLolaResults_summary.txt --rowHeaderIndex 2 --rowHeaderElementIndex 1

# Compare human brain clusters to other human brain enhancer datasets
# Neuronal activity (hg19)
/home/ikaplow/RegulatoryElementEvolutionProject/src/liftOver /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData11_15minH3K27acUp.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/LiftoverChains/hg19ToHg38.over.chain.gz /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData11_15minH3K27acUp_hg38.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData11_15minH3K27acUp_unmapped.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/liftOver /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData11_15minH3K27acDown.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/LiftoverChains/hg19ToHg38.over.chain.gz /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData11_15minH3K27acDown_hg38.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData11_15minH3K27acDown_unmapped.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/liftOver /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData11_2hrH3K27acUp.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/LiftoverChains/hg19ToHg38.over.chain.gz /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData11_2hrH3K27acUp_hg38.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData11_2hrH3K27acUp_unmapped.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/liftOver /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData11_2hrH3K27acDown.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/LiftoverChains/hg19ToHg38.over.chain.gz /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData11_2hrH3K27acDown_hg38.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData11_2hrH3K27acDown_unmapped.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/liftOver /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData12_15minH3K27acUp.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/LiftoverChains/hg19ToHg38.over.chain.gz /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData12_15minH3K27acUp_hg38.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData12_15minH3K27acUp_unmapped.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/liftOver /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData12_15minH3K27acDown.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/LiftoverChains/hg19ToHg38.over.chain.gz /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData12_15minH3K27acDown_hg38.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData12_15minH3K27acDown_unmapped.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/liftOver /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData12_2hrH3K27acUp.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/LiftoverChains/hg19ToHg38.over.chain.gz /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData12_2hrH3K27acUp_hg38.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData12_2hrH3K27acUp_unmapped.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/liftOver /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData12_2hrH3K27acDown.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/LiftoverChains/hg19ToHg38.over.chain.gz /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData12_2hrH3K27acDown_hg38.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData12_2hrH3K27acDown_unmapped.bed
intersectBed -wa -u -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData12_2hrH3K27acUp_hg38.bed -a /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/collection/regions/cluster11.bed > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData12_2hrH3K27acUp_hg38_cluster11.bed
intersectBed -wa -u -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData12_2hrH3K27acUp_hg38.bed -a /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/collection/regions/cluster48.bed > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData12_2hrH3K27acUp_hg38_cluster48.bed
intersectBed -wa -u -a /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatum_nonCDS_enhancerShort_3Col.bed -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData12_2hrH3K27acUp_hg38_cluster11.bed > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData12_2hrH3K27acUp_hg38_cluster11_forGREAT.bed
intersectBed -wa -u -a /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatum_nonCDS_enhancerShort_3Col.bed -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData12_2hrH3K27acUp_hg38_cluster48.bed > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData12_2hrH3K27acUp_hg38_cluster48_forGREAT.bed
intersectBed -wa -u -a /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData12_2hrH3K27acUp_hg38.bed -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/collection/regions/cluster11.bed > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData12_2hrH3K27acUp_hg38_inCluster11.bed
intersectBed -wa -u -a /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData12_2hrH3K27acUp_hg38.bed -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/collection/regions/cluster48.bed > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData12_2hrH3K27acUp_hg38_inCluster48.bed
sort -k1,1 -k2,2n -k3,3n /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData12_2hrH3K27acUp_hg38_inCluster11.bed | closestBed -d -t all -a stdin -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanGenome/gencode.v27.annotation.protTranscript.TSSsWithStrand_sorted.bed > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData12_2hrH3K27acUp_hg38_inCluster11_closestGene.bed
sort -k1,1 -k2,2n -k3,3n /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData12_2hrH3K27acUp_hg38_inCluster48.bed | closestBed -d -t all -a stdin -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanGenome/gencode.v27.annotation.protTranscript.TSSsWithStrand_sorted.bed > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData12_2hrH3K27acUp_hg38_inCluster48_closestGene.bed
intersectBed -wa -u -a /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatum_nonCDS_enhancerShort.bed -b /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData12_2hrH3K27acUp_hg38.bed > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData12_2hrH3K27acUp_hg38_humanBrain.bed
cut -f1-3 /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData12_2hrH3K27acUp_hg38_humanBrain.bed > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData12_2hrH3K27acUp_hg38_humanBrain_3Col.bed
python /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/getNumberUsableOrthologs.py --predictionsFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/LiftedPeaks/optimal_peak.inStriatum_nonCDS_enhancerShort_peakPredictions.txt --outputFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/LiftedPeaks/optimal_peak.inStriatum_nonCDS_enhancerShort_numUsableOrthologs.txt
python /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/filterPeakName.py --unfilteredPeakFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/LiftedPeaks/optimal_peak.inStriatum_nonCDS_enhancerShort_numUsableOrthologs.txt --unfilteredPeakNameCol 0 --peakListFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData12_2hrH3K27acUp_hg38_humanBrain.bed --peakNameCol 3 --outputFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/LiftedPeaks/optimal_peak.inStriatum_nonCDS_enhancerShort_numUsableOrthologs_Boulting2021_SuppData12_2hrH3K27acUp.txt
awk 'BEGIN{OFS="\t"} {print $1, $2+$10, $2+$10+1, $4}' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData12_2hrH3K27acUp_hg38_humanBrain.bed | /home/ikaplow/RegulatoryElementEvolutionProject/src/bigWigAverageOverBed -bedOut=/projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData12_2hrH3K27acUp_hg38_humanBrain_summitPlusMinus250bp_conservationPhastConsVertebrate.bed -sampleAroundCenter=500 -minMax /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanGenome/hg38.phastCons100way.bw stdin /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData12_2hrH3K27acUp_hg38_humanBrain_summitPlusMinus250bp_conservationPhastConsVertebrate.tab
awk 'BEGIN{OFS="\t"} {print $1, $2+$10, $2+$10+1, $4}' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData12_2hrH3K27acUp_hg38_humanBrain.bed | /home/ikaplow/RegulatoryElementEvolutionProject/src/bigWigAverageOverBed -bedOut=/projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData12_2hrH3K27acUp_hg38_humanBrain_summitPlusMinus250bp_conservationPhyloPVertebrate.bed -sampleAroundCenter=500 -minMax /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanGenome/hg38.phyloP100way.bw stdin /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Boulting2021_SuppData12_2hrH3K27acUp_hg38_humanBrain_summitPlusMinus250bp_conservationPhyloPVertebrate.tab
/home/ikaplow/RegulatoryElementEvolutionProject/src/bigWigAverageOverBed -bedOut=/projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatum_nonCDS_enhancerShort_summitPlusMinus250bp_conservationPhastConsVertebrate.bed -sampleAroundCenter=500 -minMax /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanGenome/hg38.phastCons100way.bw /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatum_nonCDS_enhancerShort_summits.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatum_nonCDS_enhancerShort_summitPlusMinus250bp_conservationPhastConsVertebrate.tab
/home/ikaplow/RegulatoryElementEvolutionProject/src/bigWigAverageOverBed -bedOut=/projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatum_nonCDS_enhancerShort_summitPlusMinus250bp_conservationPhyloPVertebrate.bed -sampleAroundCenter=500 -minMax /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanGenome/hg38.phyloP100way.bw /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatum_nonCDS_enhancerShort_summits.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatum_nonCDS_enhancerShort_summitPlusMinus250bp_conservationPhyloPVertebrate.tab
# Neuron differentiation (hg19)
sed '1d' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Forrest2017_TableS2.txt | grep -v promoter | grep -v exon | awk 'BEGIN{OFS="\t"} $2=="yes"' | awk 'BEGIN{OFS="\t"} $3=="yes"' | awk 'BEGIN{OFS="\t"} $4=="no"' | cut -f1 | sed 's/_/\t/g' | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Forrest2017_TableS2_Nd41Down.bed
sed '1d' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Forrest2017_TableS2.txt | grep -v promoter | grep -v exon | awk 'BEGIN{OFS="\t"} $2=="yes"' | awk 'BEGIN{OFS="\t"} $3=="no"' | awk 'BEGIN{OFS="\t"} $4=="yes"' | cut -f1 | sed 's/_/\t/g' | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Forrest2017_TableS2_Nd30Down.bed
sed '1d' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Forrest2017_TableS2.txt | grep -v promoter | grep -v exon | awk 'BEGIN{OFS="\t"} $2=="yes"' | awk 'BEGIN{OFS="\t"} $3=="no"' | awk 'BEGIN{OFS="\t"} $4=="no"' | cut -f1 | sed 's/_/\t/g' | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Forrest2017_TableS2_iPSCUp.bed
sed '1d' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Forrest2017_TableS2.txt | grep -v promoter | grep -v exon | awk 'BEGIN{OFS="\t"} $2=="no"' | awk 'BEGIN{OFS="\t"} $3=="yes"' | awk 'BEGIN{OFS="\t"} $4=="yes"' | cut -f1 | sed 's/_/\t/g' | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Forrest2017_TableS2_iPSCDown.bed
sed '1d' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Forrest2017_TableS2.txt | grep -v promoter | grep -v exon | awk 'BEGIN{OFS="\t"} $2=="no"' | awk 'BEGIN{OFS="\t"} $3=="yes"' | awk 'BEGIN{OFS="\t"} $4=="no"' | cut -f1 | sed 's/_/\t/g' | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Forrest2017_TableS2_Nd30Up.bed
sed '1d' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Forrest2017_TableS2.txt | grep -v promoter | grep -v exon | awk 'BEGIN{OFS="\t"} $2=="no"' | awk 'BEGIN{OFS="\t"} $3=="no"' | awk 'BEGIN{OFS="\t"} $4=="yes"' | cut -f1 | sed 's/_/\t/g' | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Forrest2017_TableS2_Nd41Up.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/liftOver /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Forrest2017_TableS2_Nd41Down.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/LiftoverChains/hg19ToHg38.over.chain.gz /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Forrest2017_TableS2_Nd41Down_hg38.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Forrest2017_TableS2_Nd41Down_unmapped.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/liftOver /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Forrest2017_TableS2_Nd30Down.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/LiftoverChains/hg19ToHg38.over.chain.gz /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Forrest2017_TableS2_Nd30Down_hg38.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Forrest2017_TableS2_Nd30Down_unmapped.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/liftOver /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Forrest2017_TableS2_iPSCUp.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/LiftoverChains/hg19ToHg38.over.chain.gz /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Forrest2017_TableS2_iPSCUp_hg38.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Forrest2017_TableS2_iPSCUp_unmapped.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/liftOver /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Forrest2017_TableS2_iPSCDown.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/LiftoverChains/hg19ToHg38.over.chain.gz /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Forrest2017_TableS2_iPSCDown_hg38.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Forrest2017_TableS2_iPSCDown_unmapped.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/liftOver /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Forrest2017_TableS2_Nd30Up.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/LiftoverChains/hg19ToHg38.over.chain.gz /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Forrest2017_TableS2_Nd30Up_hg38.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Forrest2017_TableS2_Nd30Up_unmapped.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/liftOver /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Forrest2017_TableS2_Nd41Up.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/LiftoverChains/hg19ToHg38.over.chain.gz /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Forrest2017_TableS2_Nd41Up_hg38.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Forrest2017_TableS2_Nd41Up_unmapped.bed
# AD (hg19)
grep Enhancer /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Klein2018_SupplementaryTable3_Tau.txt | awk 'BEGIN{OFS="\t"} {print $5, $2, $3}' | sed 's/,//g' | sed 's/^/chr/g' | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Klein2018_SupplementaryTable3_Tau.bed
grep Enhancer /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Klein2018_SupplementaryTable3_Amyloid.txt | awk 'BEGIN{OFS="\t"} {print $5, $2, $3}' | sed 's/,//g' | sed 's/^/chr/g' | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Klein2018_SupplementaryTable3_Amyloid.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/liftOver /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Klein2018_SupplementaryTable3_Tau.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/LiftoverChains/hg19ToHg38.over.chain.gz /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Klein2018_SupplementaryTable3_Tau_hg38.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Klein2018_SupplementaryTable3_Tau_unmapped.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/liftOver /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Klein2018_SupplementaryTable3_Amyloid.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/LiftoverChains/hg19ToHg38.over.chain.gz /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Klein2018_SupplementaryTable3_Amyloid_hg38.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Klein2018_SupplementaryTable3_Amyloid_unmapped.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/liftOver /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Klein2018_SupplementaryTable10.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/LiftoverChains/hg19ToHg38.over.chain.gz /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Klein2018_SupplementaryTable10_hg38.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Klein2018_SupplementaryTable10_unmapped.bed
# Neurons versus glia (hg19)
/home/ikaplow/RegulatoryElementEvolutionProject/src/liftOver /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Fullard2018_SupplementalTableS4_NeuronSpecific.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/LiftoverChains/hg19ToHg38.over.chain.gz /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Fullard2018_SupplementalTableS4_NeuronSpecific_hg38.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Fullard2018_SupplementalTableS4_NeuronSpecific_unmapped.bed
/home/ikaplow/RegulatoryElementEvolutionProject/src/liftOver /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Fullard2018_SupplementalTableS4_NonNeuronSpecific.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/LiftoverChains/hg19ToHg38.over.chain.gz /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Fullard2018_SupplementalTableS4_NonNeuronSpecific_hg38.bed /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Fullard2018_SupplementalTableS4_NonNeuronSpecific_unmapped.bed
# GABAergic neuron differentiation (hg38)
grep Shared /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Inglis2020_TableS4.txt | grep -v promoter | grep -v exon | cut -f2-4,28-29,31-32 | awk 'BEGIN{OFS="\t"} $4>1' | awk 'BEGIN{OFS="\t"} $5<0.05' | awk 'BEGIN{OFS="\t"} $6>1' | awk 'BEGIN{OFS="\t"} $7<0.05' | cut -f1-3 | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Inglis2020_TableS4_D50VsD22Up.bed
grep Shared /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Inglis2020_TableS4.txt | grep -v promoter | grep -v exon | cut -f2-4,28-29,31-32 | awk 'BEGIN{OFS="\t"} $4<-1' | awk 'BEGIN{OFS="\t"} $5<0.05' | awk 'BEGIN{OFS="\t"} $6<-1' | awk 'BEGIN{OFS="\t"} $7<0.05' | cut -f1-3 | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Inglis2020_TableS4_D50VsD22Down.bed
grep Shared /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Inglis2020_TableS4.txt | grep -v promoter | grep -v exon | cut -f2-4,34-35,37-38 | awk 'BEGIN{OFS="\t"} $4>1' | awk 'BEGIN{OFS="\t"} $5<0.05' | awk 'BEGIN{OFS="\t"} $6>1' | awk 'BEGIN{OFS="\t"} $7<0.05' | cut -f1-3 | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Inglis2020_TableS4_D78VsD22Up.bed
grep Shared /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Inglis2020_TableS4.txt | grep -v promoter | grep -v exon | cut -f2-4,34-35,37-38 | awk 'BEGIN{OFS="\t"} $4<-1' | awk 'BEGIN{OFS="\t"} $5<0.05' | awk 'BEGIN{OFS="\t"} $6<-1' | awk 'BEGIN{OFS="\t"} $7<0.05' | cut -f1-3 | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Inglis2020_TableS4_D78VsD22Down.bed
grep Shared /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Inglis2020_TableS4.txt | grep -v promoter | grep -v exon | cut -f2-4,40-41,43-44 | awk 'BEGIN{OFS="\t"} $4>1' | awk 'BEGIN{OFS="\t"} $5<0.05' | awk 'BEGIN{OFS="\t"} $6>1' | awk 'BEGIN{OFS="\t"} $7<0.05' | cut -f1-3 | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Inglis2020_TableS4_D78VsD50Up.bed
grep Shared /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Inglis2020_TableS4.txt | grep -v promoter | grep -v exon | cut -f2-4,40-41,43-44 | awk 'BEGIN{OFS="\t"} $4<-1' | awk 'BEGIN{OFS="\t"} $5<0.05' | awk 'BEGIN{OFS="\t"} $6<-1' | awk 'BEGIN{OFS="\t"} $7<0.05' | cut -f1-3 | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/Inglis2020_TableS4_D78VsD50Down.bed
 Run LOLA
python /home/ikaplow/RegulatoryElementEvolutionProject/src/IMKTFBindingCode/makeLolaScript.py --queryRegionListFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/HumanBrainEnhancers/humanBrainEnhancerFileNames.txt --universeDataFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatum_nonCDS_enhancerShort.bed --dbLocation /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/ --scriptFileName /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/runLolaHumanBrainEnhancerSetsScript.sh --bedMade --queriesAreBeds --path /home/ikaplow/RegulatoryElementEvolutionProject/src/IMKTFBindingCode --redefineUserSets
sh /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/runLolaHumanBrainEnhancerSetsScript.sh
python /home/ikaplow/RegulatoryElementEvolutionProject/src/IMKTFBindingCode/processLolaResults.py --lolaResultsFileNameListFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatum_nonCDS_enhancerShort_enhSetLolaResultsFileNames.txt --lolaHeadersFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/LolaHeaders.txt --outputFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatum_nonCDS_enhancerShort_enhSetLolaResults_summary.txt --rowHeaderIndex 0 --rowHeaderElementIndex 2
# Evaluate LOLA for only neuron activity (top enrichments except cluster 74 are consistent when more enhancer sets are included in evaluation)
python /home/ikaplow/RegulatoryElementEvolutionProject/src/IMKTFBindingCode/processLolaResults.py --lolaResultsFileNameListFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatum_nonCDS_enhancerShort_neuronActivityLolaResultsFileNames.txt --lolaHeadersFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/LolaHeaders.txt --outputFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatum_nonCDS_enhancerShort_neuronActivityLolaResults_summary.txt --rowHeaderIndex 0 --rowHeaderElementIndex 2
# Evaluate LOLA for only neuron activity from 4G samples
python /home/ikaplow/RegulatoryElementEvolutionProject/src/IMKTFBindingCode/processLolaResults.py --lolaResultsFileNameListFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatum_nonCDS_enhancerShort_neuronActivity4GLolaResultsFileNames.txt --lolaHeadersFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/LolaHeaders.txt --outputFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/HumanDNase/PMC/cromwell-executions/atac/45c4bd8c-c055-4cea-80c9-5ec0eeaf8024/call-reproducibility_idr/execution/optimal_peak.inStriatum_nonCDS_enhancerShort_neuronActivity4GLolaResults_summary.txt --rowHeaderIndex 0 --rowHeaderElementIndex 2

# Compare macaque brain clusters to other macaque brain enhancer datasets
sed '1d' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MacaqueBrainEnhancers/Kozlenkov2020_DatasetS4.txt | grep Glu_DA | cut -f1-3 | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MacaqueBrainEnhancers/Kozlenkov2020_DatasetS4_Glu_DA.bed
sed '1d' /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MacaqueBrainEnhancers/Kozlenkov2020_DatasetS4.txt | grep GABA_DA | cut -f1-3 | sort -k1,1 -k2,2n -k3,3n > /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MacaqueBrainEnhancers/Kozlenkov2020_DatasetS4_GABA_DA.bed
python /home/ikaplow/RegulatoryElementEvolutionProject/src/IMKTFBindingCode/makeLolaScript.py --queryRegionListFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/EnhancerDatasets/BrainEnhancers/MacaqueBrainEnhancers/macaqueBrainEnhancerFileNames.txt --universeDataFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatum_nonCDS_enhancerShort.bed --dbLocation /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility --scriptFileName /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/runLolaMacaqueBrainEnhancerSetsScript.sh --bedMade --queriesAreBeds --path /home/ikaplow/RegulatoryElementEvolutionProject/src/IMKTFBindingCode --redefineUserSets
sh /home/ikaplow/RegulatoryElementEvolutionProject/src/RegElEvoCode/runLolaMacaqueBrainEnhancerSetsScript.sh
python /home/ikaplow/RegulatoryElementEvolutionProject/src/IMKTFBindingCode/processLolaResults.py --lolaResultsFileNameListFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatum_nonCDS_enhancerShort_enhSetLolaResultsFileNames.txt --lolaHeadersFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/LolaHeaders.txt --outputFileName /projects/pfenninggroup/machineLearningForComputationalBiology/regElEvoGrant/MacaqueAtac/OfM/peak/idr_reproducibility/idr.optimal_peak.inM1AndStriatum_nonCDS_enhancerShort_enhSetLolaResults_summary.txt --rowHeaderIndex 0 --rowHeaderElementIndex 2
